<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sidçš„é³´æ½®æ™ºæ…§ç´ æéœ€æ±‚è¨ˆç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- åŠ å¯†çš„ Google Analytics ä»£ç¢¼ -->
<script>
    // ä½¿ç”¨ Base64 + ç°¡å–®æ··æ·†åŠ å¯† GA ä»£ç¢¼
    const encrypted_ga = "PHNjcmlwdCBhc3luYyBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9Ry1SNTNDSjZRRUJHIj48L3NjcmlwdD4KPHNjcmlwdD4KICA7KGZ1bmN0aW9uKCl7CiAgICB3aW5kb3cuZGF0YUxheWVyID0gd2luZG93LmRhdGFMYXllciB8fCBbXTsKICAgIGZ1bmN0aW9uIGd0YWcoKXtkYXRhTGF5ZXIucHVzaChhcmd1bWVudHMpO30KICAgIGd0YWcoJ2pzJywgbmV3IERhdGUoKSk7CiAgICBndGFnKCdjb25maWcnLCAnRy1SNTNDSjZRRUJHJyk7CiAgfSkoKTsKPC9zY3JpcHQ+";
    
    function loadGA() {
        // è§£å¯†ä¸¦è¼‰å…¥ GA
        const decoded = atob(encrypted_ga);
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = decoded;
        
        // åŸ·è¡Œè§£å¯†å¾Œçš„è…³æœ¬
        const scripts = tempDiv.getElementsByTagName('script');
        for(let i = 0; i < scripts.length; i++) {
            const newScript = document.createElement('script');
            if(scripts[i].src) {
                newScript.src = scripts[i].src;
                newScript.async = true;
            } else {
                newScript.text = scripts[i].text;
            }
            document.head.appendChild(newScript);
        }
    }
    
    // å»¶é²è¼‰å…¥ GA (é¿å…å½±éŸ¿é é¢è¼‰å…¥é€Ÿåº¦)
    window.addEventListener('load', function() {
        setTimeout(loadGA, 1000);
    });
</script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');

        :root {
            --wuwa-ink: #0b1020;
            --wuwa-night: #111827;
            --wuwa-mist: #e6eef7;
            --wuwa-cloud: #f5f7fb;
            --wuwa-cyan: #5ad7d8;
            --wuwa-teal: #18b7b3;
            --wuwa-emerald: #22c39a;
            --wuwa-amber: #d6b35f;
            --wuwa-rose: #ef7d8c;
            --wuwa-shadow: rgba(6, 12, 26, 0.45);
        }
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background:
                radial-gradient(900px 520px at 12% 12%, rgba(90, 215, 216, 0.22), transparent 60%),
                radial-gradient(900px 520px at 88% 18%, rgba(214, 179, 95, 0.2), transparent 60%),
                linear-gradient(135deg, #0b1020 0%, #101a2b 45%, #1b2b3f 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #1f2937;
        }

        .page-bg {
            position: fixed;
            inset: 0;
            background:
                radial-gradient(1200px 600px at 10% 10%, rgba(90, 215, 216, 0.2), transparent 60%),
                radial-gradient(900px 500px at 90% 20%, rgba(214, 179, 95, 0.16), transparent 55%),
                var(--wuwa-scene-1) center / cover no-repeat;
            opacity: 0.2;
            mix-blend-mode: screen;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
        }
        
        .card {
            background: rgba(245, 247, 251, 0.96);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 26px 60px rgba(8, 16, 32, 0.32), 0 0 0 1px rgba(255,255,255,0.08);
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
            isolation: isolate;
        }

        .card > * {
            position: relative;
            z-index: 1;
        }

        .card::after {
            content: "";
            position: absolute;
            right: -60px;
            top: -60px;
            width: 220px;
            height: 220px;
            background: var(--wuwa-artwork) center / cover no-repeat;
            opacity: 0.07;
            transform: rotate(8deg);
            pointer-events: none;
        }

        .card.theme-1::before,
        .card.theme-2::before,
        .card.theme-3::before,
        .card.theme-4::before {
            content: "";
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.22;
            filter: saturate(1.15) contrast(1.05);
        }

        .card.theme-1::before {
            background:
                linear-gradient(135deg, rgba(90, 215, 216, 0.18), rgba(255, 255, 255, 0.0)),
                var(--wuwa-scene-1) center / cover no-repeat;
        }

        .card.theme-2::before {
            background:
                linear-gradient(135deg, rgba(34, 195, 154, 0.16), rgba(255, 255, 255, 0.0)),
                var(--wuwa-scene-2) center / cover no-repeat;
        }

        .card.theme-3::before {
            background:
                linear-gradient(135deg, rgba(90, 215, 216, 0.16), rgba(255, 255, 255, 0.0)),
                var(--wuwa-hero) center / cover no-repeat;
        }

        .card.theme-4::before {
            background:
                linear-gradient(135deg, rgba(214, 179, 95, 0.2), rgba(255, 255, 255, 0.0)),
                var(--wuwa-artwork) center / cover no-repeat;
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 35px 70px rgba(6, 12, 26, 0.45), 0 0 0 1px rgba(255,255,255,0.12);
        }
        
        .card-title {
            color: #0f172a;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .card-content {
            color: #334155;
        }
        
        .material-green { color: #169a85; }
        .material-blue { color: #3aa0b3; }
        .material-purple { color: #6b7bd6; }
        .material-gold { color: #b88d33; }
        
        .btn-primary {
            background: linear-gradient(135deg, #0e9399, #18b7b3);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(14, 147, 153, 0.35);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(14, 147, 153, 0.45);
            background: linear-gradient(135deg, #0b7c82, #12a7a4);
        }
        
        .btn-primary:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.6);
            transition: all 0.1s ease;
        }
        
        .btn-primary:focus {
            outline: none;
            box-shadow: 0 8px 25px rgba(14, 147, 153, 0.35), 0 0 0 3px rgba(14, 147, 153, 0.25);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #1f2937, #334155);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(15, 23, 42, 0.35);
            background: linear-gradient(135deg, #0f172a, #1f2937);
        }
        
        .btn-secondary:active {
            transform: translateY(0px);
            transition: all 0.1s ease;
        }
        
        .btn-secondary:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 41, 59, 0.35);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #22c39a, #11998e);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(34, 195, 154, 0.35);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(34, 195, 154, 0.45);
            background: linear-gradient(135deg, #0f8b7a, #0b7468);
        }
        
        .btn-success:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.6);
            transition: all 0.1s ease;
        }
        
        .btn-success:focus {
            outline: none;
            box-shadow: 0 8px 25px rgba(34, 195, 154, 0.35), 0 0 0 3px rgba(34, 195, 154, 0.25);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #d6b35f, #c49334);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(214, 179, 95, 0.35);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(214, 179, 95, 0.45);
            background: linear-gradient(135deg, #b98a2b, #a7771d);
        }
        
        .btn-warning:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.6);
            transition: all 0.1s ease;
        }
        
        .btn-warning:focus {
            outline: none;
            box-shadow: 0 8px 25px rgba(214, 179, 95, 0.35), 0 0 0 3px rgba(214, 179, 95, 0.25);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #5ad7d8, #2fbfd1);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(47, 191, 209, 0.35);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn-info:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(47, 191, 209, 0.45);
            background: linear-gradient(135deg, #2aa5b8, #1e8a9c);
        }
        
        .btn-info:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.6);
            transition: all 0.1s ease;
        }
        
        .btn-info:focus {
            outline: none;
            box-shadow: 0 8px 25px rgba(47, 191, 209, 0.35), 0 0 0 3px rgba(47, 191, 209, 0.25);
        }
        
        .slider-track {
            background: linear-gradient(to right, #e2e8f0 0%, #18b7b3 100%);
            height: 6px;
            border-radius: 3px;
        }
        
        .input-field {
            border: 2px solid #d7e2ee;
            border-radius: 12px;
            padding: 10px 15px;
            transition: border-color 0.3s ease;
            background: #f9fbff;
            color: #1f2937;
        }
        
        .input-field:focus {
            border-color: #18b7b3;
            outline: none;
            box-shadow: 0 0 0 3px rgba(24, 183, 179, 0.12);
        }
        
        .status-success {
            color: #0f9b78;
            font-weight: 600;
        }
        
        .status-error {
            color: #e35d6a;
            font-weight: 600;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* æŒ‰éˆ•é»æ“Šæ³¢ç´‹æ•ˆæœ */
        @keyframes ripple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .btn-ripple {
            position: relative;
            overflow: hidden;
        }
        
        .btn-ripple::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn-ripple:active::before {
            width: 300px;
            height: 300px;
            transition: 0s;
        }
        
        /* è„ˆè¡å¢å¼·æ•ˆæœ */
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .btn-heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        
        /* å‘¼å¸ç‡ˆæ•ˆæœ */
        @keyframes breathe {
            0%, 100% { 
                box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 8px 35px rgba(99, 102, 241, 0.6);
                transform: scale(1.02);
            }
        }
        
        .btn-breathe {
            animation: breathe 3s ease-in-out infinite;
        }
        
        /* æ–æ“ºæ•ˆæœ */
        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(3deg); }
            75% { transform: rotate(-3deg); }
        }
        
        .btn-wiggle:hover {
            animation: wiggle 0.5s ease-in-out;
        }
        
        /* å½ˆè·³æ•ˆæœ */
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0,-10px,0);
            }
            70% {
                transform: translate3d(0,-5px,0);
            }
            90% {
                transform: translate3d(0,-2px,0);
            }
        }
        
        .btn-bounce:hover {
            animation: bounce 1s ease;
        }
        
        /* loading æ—‹è½‰å‹•ç•« */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .btn-loading {
            position: relative;
            color: transparent !important;
        }
        
        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            top: 50%;
            left: 50%;
            margin-left: -8px;
            margin-top: -8px;
            border: 2px solid transparent;
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* æˆåŠŸæç¤ºå‹•ç•« */
        @keyframes checkmark {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .btn-success-check::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: checkmark 0.6s ease;
        }
        
        .report-section {
            background: rgba(245, 247, 251, 0.98);
            color: #0f172a;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 25px 60px rgba(8, 16, 32, 0.32), 0 0 0 1px rgba(255,255,255,0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .header-title {
            color: #f8fafc;
            text-shadow: 0 4px 10px rgba(7, 15, 30, 0.6);
        }
        
        .header-subtitle {
            color: rgba(226, 241, 246, 0.92);
            text-shadow: 0 2px 6px rgba(7, 15, 30, 0.5);
        }

        .accent-divider {
            height: 120px;
            border-radius: 24px;
            margin: 18px 0 28px;
            background:
                linear-gradient(135deg, rgba(10, 17, 30, 0.35), rgba(255, 255, 255, 0.18)),
                var(--wuwa-scene-2) center / cover no-repeat;
            box-shadow: 0 18px 40px rgba(7, 15, 30, 0.45);
            border: 1px solid rgba(255,255,255,0.2);
        }

        @media (max-width: 640px) {
            .page-bg {
                background:
                    radial-gradient(900px 420px at 10% 10%, rgba(255, 255, 255, 0.16), transparent 60%),
                    radial-gradient(700px 380px at 90% 20%, rgba(255, 255, 255, 0.12), transparent 55%),
                    var(--wuwa-scene-1) center / cover no-repeat;
            }

            .accent-divider {
                height: 90px;
            }
        }
        
        .language-btn {
            background: rgba(11, 16, 32, 0.35);
            border: 1px solid rgba(248, 250, 252, 0.3);
            color: rgba(241, 247, 255, 0.95);
            padding: 8px 16px;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .language-btn:hover {
            background: rgba(11, 16, 32, 0.48);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(7, 15, 30, 0.45);
        }
        
        .language-btn:active {
            transform: translateY(0px);
            transition: all 0.1s ease;
        }
        
        .language-btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(90, 215, 216, 0.35);
        }
        
        .language-btn.active {
            background: rgba(248, 250, 252, 0.95);
            color: #0f172a;
            font-weight: 600;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(7, 15, 30, 0.35);
        }
        
        .record-item {
            background: rgba(24, 183, 179, 0.08);
            border: 1px solid rgba(24, 183, 179, 0.28);
            border-radius: 12px;
            padding: 12px 16px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .record-item:hover {
            background: rgba(24, 183, 179, 0.16);
            border-color: rgba(24, 183, 179, 0.45);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(8, 16, 32, 0.25);
        }
        
        .record-item:active {
            transform: translateY(0px);
            transition: all 0.1s ease;
        }
        
        .record-item.active {
            background: rgba(24, 183, 179, 0.22);
            border-color: rgba(24, 183, 179, 0.55);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(8, 16, 32, 0.3);
        }
        
        .record-delete {
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }
        
        .record-item:hover .record-delete {
            opacity: 1;
        }
        
        /* æŒ‰éˆ•ç¦ç”¨ç‹€æ…‹ */
        .btn-primary:disabled,
        .btn-secondary:disabled,
        .btn-success:disabled,
        .btn-warning:disabled,
        .btn-info:disabled {
            background: #9aa5b1;
            color: #6b7785;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: 0 2px 4px rgba(7, 15, 30, 0.15) !important;
            opacity: 0.6;
        }
        
        .btn-primary:disabled:hover,
        .btn-secondary:disabled:hover,
        .btn-success:disabled:hover,
        .btn-warning:disabled:hover,
        .btn-info:disabled:hover {
            transform: none !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        }
        
        /* æŒ‰éˆ•åŠ è¼‰ç‹€æ…‹æ“´å±• */
        .btn-loading:disabled {
            cursor: wait;
            opacity: 0.8;
        }

        :root {
            --wuwa-hero: url("https://images.igdb.com/igdb/image/upload/t_720p/scuir8.png");
            --wuwa-keyart: url("https://images.igdb.com/igdb/image/upload/t_720p/ar4pw6.png");
            --wuwa-scene-1: url("https://images.igdb.com/igdb/image/upload/t_720p/scuir7.png");
            --wuwa-scene-2: url("https://images.igdb.com/igdb/image/upload/t_720p/scuira.png");
            --wuwa-artwork: url("https://images.igdb.com/igdb/image/upload/t_720p/ar1nwd.png");
        }

        .hero {
            position: relative;
            padding: 48px 24px;
            border-radius: 24px;
            background:
                linear-gradient(135deg, rgba(79, 70, 229, 0.72), rgba(124, 58, 237, 0.72), rgba(236, 72, 153, 0.72)),
                var(--wuwa-hero) center/cover no-repeat;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .hero::after {
            content: "";
            position: absolute;
            right: -30px;
            bottom: -30px;
            width: 260px;
            height: 260px;
            background: var(--wuwa-keyart) center/cover no-repeat;
            opacity: 0.18;
            filter: saturate(1.2);
            pointer-events: none;
        }

        @media (max-width: 640px) {
            .hero::after {
                width: 180px;
                height: 180px;
                right: -20px;
                bottom: -20px;
            }
        }
    </style>
</head>
<body>
    <div class="page-bg" aria-hidden="true"></div>
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header with Language Selector -->
        <div class="text-center mb-8 hero">
            <div class="flex justify-end mb-4">
                <div class="flex gap-2">
                    <button id="lang-zh" class="language-btn active" data-lang="zh">ä¸­æ–‡</button>
                    <button id="lang-en" class="language-btn" data-lang="en">English</button>
                </div>
            </div>
            <h1 class="text-4xl font-bold header-title mb-2" data-i18n="title">ğŸ® Sidçš„é³´æ½®æ™ºæ…§ç´ æéœ€æ±‚è¨ˆç®—å™¨</h1>
            <p class="header-subtitle" data-i18n="subtitle">é€†å‘æ¼”ç®—æ³•å„ªåŒ– â€¢ æ™ºæ…§åˆæˆç­–ç•¥ â€¢ é›¶æµªè²»è³‡æºé…ç½®</p>
        </div>

        <!-- User Records Section -->
        <div class="card mb-8 theme-1">
            <div class="flex flex-wrap items-center justify-between mb-6">
                <h2 class="text-2xl card-title flex items-center" data-i18n="records.title">
                    ğŸ“‹ ä½¿ç”¨è¨˜éŒ„
                </h2>
                <div class="flex gap-2 mt-2 sm:mt-0">
                    <button id="save-record-btn" class="btn-info text-sm px-4 py-2" data-i18n="records.save">
                        ğŸ’¾ ä¿å­˜ç•¶å‰è¨­å®š
                    </button>
                    <button id="clear-records-btn" class="btn-secondary text-sm px-4 py-2" data-i18n="records.clearAll">
                        ğŸ—‘ï¸ æ¸…ç©ºè¨˜éŒ„
                    </button>
                </div>
            </div>
            <div id="records-list" class="space-y-2">
                <p class="text-gray-500 text-center" data-i18n="records.empty">ç›®å‰æ²’æœ‰ä¿å­˜çš„è¨˜éŒ„</p>
            </div>
        </div>

        <!-- ç¬¬ä¸€å€å¡Šï¼šè¨­å®šå€åŸŸ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- è§’è‰²æŠ€èƒ½è¨­å®š -->
            <div class="card theme-2">
                <div class="flex flex-wrap items-center justify-between mb-6">
                    <h2 class="text-2xl card-title flex items-center" data-i18n="skills.title">
                        âš”ï¸ è§’è‰²æŠ€èƒ½ç­‰ç´š
                    </h2>
                    <div class="flex gap-2 mt-2 sm:mt-0">
                        <button id="skill-level-6" class="btn-secondary text-sm px-3 py-1" data-i18n="skills.level6">
                            6ç­‰
                        </button>
                        <button id="skill-level-8" class="btn-secondary text-sm px-3 py-1" data-i18n="skills.level8">
                            8ç­‰
                        </button>
                        <button id="skill-level-10" class="btn-secondary text-sm px-3 py-1" data-i18n="skills.level10">
                            10ç­‰
                        </button>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="skills.normal">å¸¸æ…‹æ”»æ“Š</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="skill1" min="1" max="10" value="1" 
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">10</span>
                            <span id="skill1-value" class="text-xl font-bold material-blue w-8 text-center">1</span>
                        </div>
                    </div>
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="skills.resonance">å…±é³´æŠ€èƒ½</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="skill2" min="1" max="10" value="1" 
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">10</span>
                            <span id="skill2-value" class="text-xl font-bold material-blue w-8 text-center">1</span>
                        </div>
                    </div>
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="skills.liberation">å…±é³´è§£æ”¾</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="skill3" min="1" max="10" value="1" 
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">10</span>
                            <span id="skill3-value" class="text-xl font-bold material-blue w-8 text-center">1</span>
                        </div>
                    </div>
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="skills.variation">è®Šå¥æŠ€èƒ½</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="skill4" min="1" max="10" value="1" 
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">10</span>
                            <span id="skill4-value" class="text-xl font-bold material-blue w-8 text-center">1</span>
                        </div>
                    </div>
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="skills.circuit">å…±é³´è¿´è·¯</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="skill5" min="1" max="10" value="1" 
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">10</span>
                            <span id="skill5-value" class="text-xl font-bold material-blue w-8 text-center">1</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ­¦å™¨è¨­å®šèˆ‡ç›®æ¨™éœ€æ±‚ -->
            <div class="space-y-6">
                <!-- æ­¦å™¨ç­‰ç´šè¨­å®š -->
                <div class="card theme-3">
                    <h2 class="text-2xl card-title flex items-center mb-6" data-i18n="weapon.title">
                        ğŸ—¡ï¸ æ­¦å™¨çªç ´ç­‰ç´š
                    </h2>
                    <div class="skill-control">
                        <label class="block text-base font-medium card-content mb-3" data-i18n="weapon.level">æ­¦å™¨ç­‰ç´š</label>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm card-content w-4">1</span>
                            <input type="range" id="weapon" min="0" max="6" value="0" step="1"
                                   class="flex-1 h-3 rounded-lg appearance-none cursor-pointer slider-track">
                            <span class="text-sm card-content w-6">90</span>
                            <span id="weapon-value" class="text-xl font-bold material-purple w-12 text-center">1ç´š</span>
                        </div>
                    </div>
                </div>

                <!-- ç›®æ¨™éœ€æ±‚ -->
                <div class="card theme-4">
                    <h2 class="text-xl card-title flex items-center mb-4" data-i18n="target.title">
                        ğŸ¯ ç›®æ¨™éœ€æ±‚ç¸½è¨ˆ
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-green-50 rounded-lg p-4 text-center border-2 border-green-200">
                            <div class="text-2xl mb-2">ğŸŸ¢</div>
                            <div class="text-sm card-content font-medium mb-1" data-i18n="materials.green">ç¶ è‰²ç´ æ</div>
                            <div id="target-green" class="text-2xl font-bold material-green">0</div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-4 text-center border-2 border-blue-200">
                            <div class="text-2xl mb-2">ğŸ”µ</div>
                            <div class="text-sm card-content font-medium mb-1" data-i18n="materials.blue">è—è‰²ç´ æ</div>
                            <div id="target-blue" class="text-2xl font-bold material-blue">0</div>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-4 text-center border-2 border-purple-200">
                            <div class="text-2xl mb-2">ğŸŸ£</div>
                            <div class="text-sm card-content font-medium mb-1" data-i18n="materials.purple">ç´«è‰²ç´ æ</div>
                            <div id="target-purple" class="text-2xl font-bold material-purple">0</div>
                        </div>
                        <div class="bg-yellow-50 rounded-lg p-4 text-center border-2 border-yellow-200">
                            <div class="text-2xl mb-2">ğŸŸ¡</div>
                            <div class="text-sm card-content font-medium mb-1" data-i18n="materials.gold">é‡‘è‰²ç´ æ</div>
                            <div id="target-gold" class="text-2xl font-bold material-gold">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¬¬äºŒå€å¡Šï¼šæŒæœ‰æ•¸é‡è¼¸å…¥ -->
        <div class="card mb-8 theme-1">
            <h2 class="text-2xl card-title flex items-center mb-6" data-i18n="current.title">
                ğŸ“¦ ç•¶å‰æŒæœ‰æ•¸é‡
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="text-center">
                    <div class="bg-green-50 rounded-xl p-4 mb-4 border-2 border-green-200 hover:border-green-300 transition-colors">
                        <span class="text-3xl block mb-2">ğŸŸ¢</span>
                        <p class="text-base font-semibold material-green mb-2" data-i18n="materials.green">ç¶ è‰²ç´ æ</p>
                    </div>
                    <input type="number" id="current-green" value="0" min="0" 
                           class="input-field w-full text-center text-lg font-semibold" placeholder="0">
                </div>
                <div class="text-center">
                    <div class="bg-blue-50 rounded-xl p-4 mb-4 border-2 border-blue-200 hover:border-blue-300 transition-colors">
                        <span class="text-3xl block mb-2">ğŸ”µ</span>
                        <p class="text-base font-semibold material-blue mb-2" data-i18n="materials.blue">è—è‰²ç´ æ</p>
                    </div>
                    <input type="number" id="current-blue" value="0" min="0" 
                           class="input-field w-full text-center text-lg font-semibold" placeholder="0">
                </div>
                <div class="text-center">
                    <div class="bg-purple-50 rounded-xl p-4 mb-4 border-2 border-purple-200 hover:border-purple-300 transition-colors">
                        <span class="text-3xl block mb-2">ğŸŸ£</span>
                        <p class="text-base font-semibold material-purple mb-2" data-i18n="materials.purple">ç´«è‰²ç´ æ</p>
                    </div>
                    <input type="number" id="current-purple" value="0" min="0" 
                           class="input-field w-full text-center text-lg font-semibold" placeholder="0">
                </div>
                <div class="text-center">
                    <div class="bg-yellow-50 rounded-xl p-4 mb-4 border-2 border-yellow-200 hover:border-yellow-300 transition-colors">
                        <span class="text-3xl block mb-2">ğŸŸ¡</span>
                        <p class="text-base font-semibold material-gold mb-2" data-i18n="materials.gold">é‡‘è‰²ç´ æ</p>
                    </div>
                    <input type="number" id="current-gold" value="0" min="0" 
                           class="input-field w-full text-center text-lg font-semibold" placeholder="0">
                </div>
            </div>
        </div>

        <!-- ç¬¬ä¸‰å€å¡Šï¼šå¿«æ·æ“ä½œæŒ‰éˆ• -->
        <div class="card mb-8 theme-2">
            <div class="flex flex-wrap gap-4 justify-center">
                <button id="max-cultivation-btn" class="btn-primary text-lg px-8 py-4" data-i18n="buttons.maxCultivation">
                    ğŸ“ ä¸€éµç•¢æ¥­éœ€æ±‚
                </button>
                <button id="reset-default-btn" class="btn-success text-lg px-8 py-4" data-i18n="buttons.resetDefault">
                    ğŸ¯ é‡ç½®é è¨­
                </button>
                <button id="reset-all-btn" class="btn-secondary text-lg px-8 py-4" data-i18n="buttons.resetAll">
                    ğŸ”„ é‡ç½®æ•¸æ“š
                </button>
                <button id="copy-report-btn" class="btn-warning text-lg px-8 py-4" data-i18n="buttons.copyReport">
                    ğŸ“‹ è¤‡è£½å ±å‘Š
                </button>
            </div>
        </div>

        <!-- ç¬¬å››å€å¡Šï¼šåˆ†æçµæœ -->
        <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8">
            <!-- ç‹€æ…‹åˆ†æ -->
            <div class="card theme-3">
                <h2 class="text-xl card-title flex items-center mb-6" data-i18n="analysis.title">
                    ğŸ“Š è³‡æºç‹€æ…‹åˆ†æ
                </h2>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b-2 border-gray-200">
                                <th class="text-left py-4 card-content font-semibold text-base" data-i18n="analysis.material">ç´ æ</th>
                                <th class="text-center py-4 card-content font-semibold text-base" data-i18n="analysis.target">ç›®æ¨™</th>
                                <th class="text-center py-4 card-content font-semibold text-base" data-i18n="analysis.current">æŒæœ‰</th>
                                <th class="text-center py-4 card-content font-semibold text-base" data-i18n="analysis.status">ç‹€æ…‹</th>
                            </tr>
                        </thead>
                        <tbody id="status-table">
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 card-content text-base">ğŸŸ¢ <span data-i18n="materials.green">ç¶ è‰²</span></td>
                                <td class="text-center py-4 card-content text-base" id="status-target-green">0</td>
                                <td class="text-center py-4 card-content text-base" id="status-current-green">0</td>
                                <td class="text-center py-4 text-base" id="status-green">-</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 card-content text-base">ğŸ”µ <span data-i18n="materials.blue">è—è‰²</span></td>
                                <td class="text-center py-4 card-content text-base" id="status-target-blue">0</td>
                                <td class="text-center py-4 card-content text-base" id="status-current-blue">0</td>
                                <td class="text-center py-4 text-base" id="status-blue">-</td>
                            </tr>
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-4 card-content text-base">ğŸŸ£ <span data-i18n="materials.purple">ç´«è‰²</span></td>
                                <td class="text-center py-4 card-content text-base" id="status-target-purple">0</td>
                                <td class="text-center py-4 card-content text-base" id="status-current-purple">0</td>
                                <td class="text-center py-4 text-base" id="status-purple">-</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="py-4 card-content text-base">ğŸŸ¡ <span data-i18n="materials.gold">é‡‘è‰²</span></td>
                                <td class="text-center py-4 card-content text-base" id="status-target-gold">0</td>
                                <td class="text-center py-4 card-content text-base" id="status-current-gold">0</td>
                                <td class="text-center py-4 text-base" id="status-gold">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- æœ€ä½³åˆæˆç­–ç•¥ -->
            <div class="card theme-4">
                <h2 class="text-xl card-title flex items-center mb-6" data-i18n="strategy.title">
                    ğŸ§  æœ€ä½³åˆæˆç­–ç•¥
                    <span class="ml-3 px-3 py-1 bg-blue-500 text-white text-sm rounded-full animate-pulse" data-i18n="strategy.smart">æ™ºæ…§æ¨è–¦</span>
                </h2>
                <div id="strategy-display" class="space-y-3">
                    <div class="bg-gray-50 rounded-lg p-4 text-center border-2 border-dashed border-gray-300">
                        <p class="card-content text-base" data-i18n="strategy.placeholder">è¼¸å…¥æŒæœ‰æ•¸é‡å¾Œè‡ªå‹•é¡¯ç¤ºæœ€ä½³ç­–ç•¥</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Execution Result Preview -->
        <div class="mt-8">
            <div class="card theme-1">
                <h2 class="text-2xl card-title flex items-center" data-i18n="preview.title">
                    ğŸ”„ åŸ·è¡Œå¾Œé è¦½
                </h2>
                <div id="execution-preview" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="bg-green-50 rounded-lg p-4 text-center border-2 border-green-200">
                        <div class="text-2xl mb-2">ğŸŸ¢</div>
                        <div class="text-sm card-content font-medium" data-i18n="materials.green">ç¶ è‰²ç´ æ</div>
                        <div id="preview-green" class="text-lg font-bold material-green">-</div>
                        <div id="preview-green-status" class="text-xs card-content">-</div>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-4 text-center border-2 border-blue-200">
                        <div class="text-2xl mb-2">ğŸ”µ</div>
                        <div class="text-sm card-content font-medium" data-i18n="materials.blue">è—è‰²ç´ æ</div>
                        <div id="preview-blue" class="text-lg font-bold material-blue">-</div>
                        <div id="preview-blue-status" class="text-xs card-content">-</div>
                    </div>
                    <div class="bg-purple-50 rounded-lg p-4 text-center border-2 border-purple-200">
                        <div class="text-2xl mb-2">ğŸŸ£</div>
                        <div class="text-sm card-content font-medium" data-i18n="materials.purple">ç´«è‰²ç´ æ</div>
                        <div id="preview-purple" class="text-lg font-bold material-purple">-</div>
                        <div id="preview-purple-status" class="text-xs card-content">-</div>
                    </div>
                    <div class="bg-yellow-50 rounded-lg p-4 text-center border-2 border-yellow-200">
                        <div class="text-2xl mb-2">ğŸŸ¡</div>
                        <div class="text-sm card-content font-medium" data-i18n="materials.gold">é‡‘è‰²ç´ æ</div>
                        <div id="preview-gold" class="text-lg font-bold material-gold">-</div>
                        <div id="preview-gold-status" class="text-xs card-content">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Section -->
        <div class="mt-8">
            <div class="report-section">
                <h2 class="text-2xl card-title flex items-center" data-i18n="report.title">
                    ğŸ“‹ æ™ºæ…§ç´ æéœ€æ±‚åˆ†æå ±å‘Š
                </h2>
                <div id="report-content" class="bg-gray-50 rounded-lg p-4 font-mono text-sm whitespace-pre-wrap border-2 border-gray-200" style="color: #2c3e50;">
è¼¸å…¥æŒæœ‰æ•¸é‡å¾Œè‡ªå‹•ç”Ÿæˆè©³ç´°å ±å‘Š...
                </div>
            </div>
        </div>

        <!-- Calculation Process Section -->
        <div class="mt-6">
            <div class="bg-gray-100 rounded-lg p-4 border border-gray-300">
                <details class="cursor-pointer">
                    <summary class="text-sm text-gray-600 font-medium hover:text-gray-800 transition-colors" data-i18n="calculation.details">
                        ğŸ” è¨ˆç®—éç¨‹è©³æƒ… (é»æ“Šå±•é–‹)
                    </summary>
                    <div class="mt-4 pt-4 border-t border-gray-300">
                        <div id="calculation-process" class="bg-white rounded p-3 font-mono text-xs text-gray-700 whitespace-pre-wrap border">
é»æ“Šä¸Šæ–¹æŒ‰éˆ•æˆ–è¼¸å…¥æ•¸æ“šå¾Œé¡¯ç¤ºè©³ç´°è¨ˆç®—éç¨‹...
                        </div>
                    </div>
                </details>
            </div>
        </div>

        <!-- Instructions -->
        <div class="mt-8 card theme-2">
            <h3 class="text-lg card-title mb-3" data-i18n="instructions.title">ğŸ“– ä½¿ç”¨èªªæ˜</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.setTarget">ğŸ¯ è¨­å®šç›®æ¨™</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.adjustSkills">â€¢ èª¿æ•´è§’è‰²æŠ€èƒ½ç­‰ç´šï¼ˆ1-10ç´šï¼‰</li>
                        <li data-i18n="instructions.setWeapon">â€¢ è¨­å®šæ­¦å™¨çªç ´ç­‰ç´šï¼ˆ1-90ç´šï¼‰</li>
                        <li data-i18n="instructions.autoCalculate">â€¢ ç³»çµ±è‡ªå‹•è¨ˆç®—æ‰€éœ€ç´ æ</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.inputHoldings">ğŸ“¦ è¼¸å…¥æŒæœ‰é‡</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.inputMaterials">â€¢ è¼¸å…¥å„è‰²ç´ æç•¶å‰æŒæœ‰æ•¸é‡</li>
                        <li data-i18n="instructions.fourTierSystem">â€¢ æ”¯æ´å››ç´šç´ æç³»çµ±</li>
                        <li data-i18n="instructions.synthesisPath">â€¢ ç¶ â†’è—â†’ç´«â†’é‡‘ åˆæˆè·¯å¾‘</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.smartCalculation">ğŸ§  æ™ºæ…§è¨ˆç®—</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.autoStrategy">â€¢ è¼¸å…¥ç´ æå¾Œè‡ªå‹•è¨ˆç®—æœ€ä½³ç­–ç•¥</li>
                        <li data-i18n="instructions.preserveGreen">â€¢ ä¿è­‰ç¶ è‰²ç´ æä¸è¢«éåº¦æ¶ˆè€—</li>
                        <li data-i18n="instructions.maxEfficiency">â€¢ æœ€å¤§åŒ–è³‡æºåˆ©ç”¨æ•ˆç‡</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.reportFeature">ğŸ“‹ å ±å‘ŠåŠŸèƒ½</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.detailedStrategy">â€¢ è©³ç´°çš„åˆæˆç­–ç•¥èªªæ˜</li>
                        <li data-i18n="instructions.beforeAfter">â€¢ åŸ·è¡Œå‰å¾Œæ•¸é‡å°æ¯”</li>
                        <li data-i18n="instructions.oneClickCopy">â€¢ ä¸€éµè¤‡è£½å®Œæ•´å ±å‘Š</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.farmingMethods">âš¡ åˆ·å–æ–¹å¼èªªæ˜</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.normal">â€¢ å¸¸è¦(40é«”/å ´): æ¨™æº–å‡ç´ é ˜åŸŸ</li>
                        <li data-i18n="instructions.safe">â€¢ å®‰å…¨(40é«”/å ´): å«ç·©è¡çš„ä¿éšªå ´æ¬¡</li>
                        <li data-i18n="instructions.doubleEvent">â€¢ æ´»å‹•é›™å€(40é«”/å ´): é›™å€æ‰è½æœŸé–“</li>
                        <li data-i18n="instructions.reduced">â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): 2å€ç´ ææ‰è½</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold card-title mb-2 text-base" data-i18n="instructions.recordFeature">ğŸ’¾ è¨˜éŒ„åŠŸèƒ½</h4>
                    <ul class="space-y-1 card-content">
                        <li data-i18n="instructions.saveSettings">â€¢ ä¿å­˜ç•¶å‰è§’è‰²å’Œæ­¦å™¨è¨­å®š</li>
                        <li data-i18n="instructions.quickLoad">â€¢ å¿«é€Ÿè¼‰å…¥ä¹‹å‰çš„é…ç½®</li>
                        <li data-i18n="instructions.manageRecords">â€¢ ç®¡ç†å’Œåˆªé™¤ä¸éœ€è¦çš„è¨˜éŒ„</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Internationalization data
        const i18nData = {
            zh: {
                title: "ğŸ® Sidçš„é³´æ½®æ™ºæ…§ç´ æéœ€æ±‚è¨ˆç®—å™¨",
                subtitle: "é€†å‘æ¼”ç®—æ³•å„ªåŒ– â€¢ æ™ºæ…§åˆæˆç­–ç•¥ â€¢ é›¶æµªè²»è³‡æºé…ç½®",
                records: {
                    title: "ğŸ“‹ ä½¿ç”¨è¨˜éŒ„",
                    save: "ğŸ’¾ ä¿å­˜ç•¶å‰è¨­å®š",
                    clearAll: "ğŸ—‘ï¸ æ¸…ç©ºè¨˜éŒ„",
                    empty: "ç›®å‰æ²’æœ‰ä¿å­˜çš„è¨˜éŒ„",
                    savePrompt: "è«‹ç‚ºé€™å€‹é…ç½®è¼¸å…¥åç¨±ï¼š",
                    defaultName: "è§’è‰²é…ç½®",
                    confirmClear: "ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„å—ï¼Ÿ",
                    deleteRecord: "åˆªé™¤é€™å€‹è¨˜éŒ„ï¼Ÿ"
                },
                skills: {
                    title: "âš”ï¸ è§’è‰²æŠ€èƒ½ç­‰ç´š",
                    level6: "6ç­‰",
                    level8: "8ç­‰",
                    level10: "10ç­‰",
                    normal: "å¸¸æ…‹æ”»æ“Š",
                    resonance: "å…±é³´æŠ€èƒ½",
                    liberation: "å…±é³´è§£æ”¾",
                    variation: "è®Šå¥æŠ€èƒ½",
                    circuit: "å…±é³´è¿´è·¯"
                },
                weapon: {
                    title: "ğŸ—¡ï¸ æ­¦å™¨çªç ´ç­‰ç´š",
                    level: "æ­¦å™¨ç­‰ç´š"
                },
                target: {
                    title: "ğŸ¯ ç›®æ¨™éœ€æ±‚ç¸½è¨ˆ"
                },
                materials: {
                    green: "ç¶ è‰²ç´ æ",
                    blue: "è—è‰²ç´ æ",
                    purple: "ç´«è‰²ç´ æ",
                    gold: "é‡‘è‰²ç´ æ"
                },
                current: {
                    title: "ğŸ“¦ ç•¶å‰æŒæœ‰æ•¸é‡"
                },
                buttons: {
                    maxCultivation: "ğŸ“ ä¸€éµç•¢æ¥­éœ€æ±‚",
                    resetDefault: "ğŸ¯ é‡ç½®é è¨­",
                    resetAll: "ğŸ”„ é‡ç½®æ•¸æ“š",
                    copyReport: "ğŸ“‹ è¤‡è£½å ±å‘Š"
                },
                analysis: {
                    title: "ğŸ“Š è³‡æºç‹€æ…‹åˆ†æ",
                    material: "ç´ æ",
                    target: "ç›®æ¨™",
                    current: "æŒæœ‰",
                    status: "ç‹€æ…‹"
                },
                strategy: {
                    title: "ğŸ§  æœ€ä½³åˆæˆç­–ç•¥",
                    smart: "æ™ºæ…§æ¨è–¦",
                    placeholder: "è¼¸å…¥æŒæœ‰æ•¸é‡å¾Œè‡ªå‹•é¡¯ç¤ºæœ€ä½³ç­–ç•¥",
                    noSynthesis: "ğŸ‰ ç„¡éœ€åˆæˆï¼Œç•¶å‰è³‡æºå·²ç¶“æœ€å„ªé…ç½®ï¼"
                },
                preview: {
                    title: "ğŸ”„ åŸ·è¡Œå¾Œé è¦½"
                },
                report: {
                    title: "ğŸ“‹ æ™ºæ…§ç´ æéœ€æ±‚åˆ†æå ±å‘Š",
                    placeholder: "è¼¸å…¥æŒæœ‰æ•¸é‡å¾Œè‡ªå‹•ç”Ÿæˆè©³ç´°å ±å‘Š..."
                },
                calculation: {
                    details: "ğŸ” è¨ˆç®—éç¨‹è©³æƒ… (é»æ“Šå±•é–‹)",
                    placeholder: "é»æ“Šä¸Šæ–¹æŒ‰éˆ•æˆ–è¼¸å…¥æ•¸æ“šå¾Œé¡¯ç¤ºè©³ç´°è¨ˆç®—éç¨‹..."
                },
                instructions: {
                    title: "ğŸ“– ä½¿ç”¨èªªæ˜",
                    setTarget: "ğŸ¯ è¨­å®šç›®æ¨™",
                    adjustSkills: "â€¢ èª¿æ•´è§’è‰²æŠ€èƒ½ç­‰ç´šï¼ˆ1-10ç´šï¼‰",
                    setWeapon: "â€¢ è¨­å®šæ­¦å™¨çªç ´ç­‰ç´šï¼ˆ1-90ç´šï¼‰",
                    autoCalculate: "â€¢ ç³»çµ±è‡ªå‹•è¨ˆç®—æ‰€éœ€ç´ æ",
                    inputHoldings: "ğŸ“¦ è¼¸å…¥æŒæœ‰é‡",
                    inputMaterials: "â€¢ è¼¸å…¥å„è‰²ç´ æç•¶å‰æŒæœ‰æ•¸é‡",
                    fourTierSystem: "â€¢ æ”¯æ´å››ç´šç´ æç³»çµ±",
                    synthesisPath: "â€¢ ç¶ â†’è—â†’ç´«â†’é‡‘ åˆæˆè·¯å¾‘",
                    smartCalculation: "ğŸ§  æ™ºæ…§è¨ˆç®—",
                    autoStrategy: "â€¢ è¼¸å…¥ç´ æå¾Œè‡ªå‹•è¨ˆç®—æœ€ä½³ç­–ç•¥",
                    preserveGreen: "â€¢ ä¿è­‰ç¶ è‰²ç´ æä¸è¢«éåº¦æ¶ˆè€—",
                    maxEfficiency: "â€¢ æœ€å¤§åŒ–è³‡æºåˆ©ç”¨æ•ˆç‡",
                    reportFeature: "ğŸ“‹ å ±å‘ŠåŠŸèƒ½",
                    detailedStrategy: "â€¢ è©³ç´°çš„åˆæˆç­–ç•¥èªªæ˜",
                    beforeAfter: "â€¢ åŸ·è¡Œå‰å¾Œæ•¸é‡å°æ¯”",
                    oneClickCopy: "â€¢ ä¸€éµè¤‡è£½å®Œæ•´å ±å‘Š",
                    farmingMethods: "âš¡ åˆ·å–æ–¹å¼èªªæ˜",
                    normal: "â€¢ å¸¸è¦(40é«”/å ´): æ¨™æº–å‡ç´ é ˜åŸŸ",
                    safe: "â€¢ å®‰å…¨(40é«”/å ´): å«ç·©è¡çš„ä¿éšªå ´æ¬¡",
                    doubleEvent: "â€¢ æ´»å‹•é›™å€(40é«”/å ´): é›™å€æ‰è½æœŸé–“",
                    reduced: "â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): 2å€ç´ ææ‰è½",
                    recordFeature: "ğŸ’¾ è¨˜éŒ„åŠŸèƒ½",
                    saveSettings: "â€¢ ä¿å­˜ç•¶å‰è§’è‰²å’Œæ­¦å™¨è¨­å®š",
                    quickLoad: "â€¢ å¿«é€Ÿè¼‰å…¥ä¹‹å‰çš„é…ç½®",
                    manageRecords: "â€¢ ç®¡ç†å’Œåˆªé™¤ä¸éœ€è¦çš„è¨˜éŒ„"
                },
                messages: {
                    recordSaved: "âœ… é…ç½®å·²ä¿å­˜ï¼",
                    recordLoaded: "âœ… é…ç½®å·²è¼‰å…¥ï¼",
                    recordDeleted: "âœ… è¨˜éŒ„å·²åˆªé™¤ï¼",
                    recordsCleared: "âœ… æ‰€æœ‰è¨˜éŒ„å·²æ¸…ç©ºï¼",
                    reportCopied: "âœ… å·²è¤‡è£½ï¼"
                }
            },
            en: {
                title: "ğŸ® Sid's Wuthering Waves Smart Material Calculator",
                subtitle: "Reverse Algorithm Optimization â€¢ Smart Synthesis Strategy â€¢ Zero Waste Resource Allocation",
                records: {
                    title: "ğŸ“‹ User Records",
                    save: "ğŸ’¾ Save Current Settings",
                    clearAll: "ğŸ—‘ï¸ Clear All",
                    empty: "No saved records currently",
                    savePrompt: "Please enter a name for this configuration:",
                    defaultName: "Character Config",
                    confirmClear: "Are you sure you want to clear all records?",
                    deleteRecord: "Delete this record?"
                },
                skills: {
                    title: "âš”ï¸ Character Skill Levels",
                    level6: "Lv.6",
                    level8: "Lv.8",
                    level10: "Lv.10",
                    normal: "Normal Attack",
                    resonance: "Resonance Skill",
                    liberation: "Resonance Liberation",
                    variation: "Variation Skill",
                    circuit: "Resonance Circuit"
                },
                weapon: {
                    title: "ğŸ—¡ï¸ Weapon Breakthrough Level",
                    level: "Weapon Level"
                },
                target: {
                    title: "ğŸ¯ Target Requirements Total"
                },
                materials: {
                    green: "Green Materials",
                    blue: "Blue Materials",
                    purple: "Purple Materials",
                    gold: "Gold Materials"
                },
                current: {
                    title: "ğŸ“¦ Current Holdings"
                },
                buttons: {
                    maxCultivation: "ğŸ“ Max Cultivation",
                    resetDefault: "ğŸ¯ Reset Default",
                    resetAll: "ğŸ”„ Reset All Data",
                    copyReport: "ğŸ“‹ Copy Report"
                },
                analysis: {
                    title: "ğŸ“Š Resource Status Analysis",
                    material: "Material",
                    target: "Target",
                    current: "Current",
                    status: "Status"
                },
                strategy: {
                    title: "ğŸ§  Optimal Synthesis Strategy",
                    smart: "Smart Recommendation",
                    placeholder: "Enter current holdings to display optimal strategy",
                    noSynthesis: "ğŸ‰ No synthesis needed, current resources are optimally configured!"
                },
                preview: {
                    title: "ğŸ”„ Post-Execution Preview"
                },
                report: {
                    title: "ğŸ“‹ Smart Material Requirement Analysis Report",
                    placeholder: "Enter current holdings to auto-generate detailed report..."
                },
                calculation: {
                    details: "ğŸ” Calculation Details (Click to expand)",
                    placeholder: "Click buttons above or enter data to show detailed calculation process..."
                },
                instructions: {
                    title: "ğŸ“– Instructions",
                    setTarget: "ğŸ¯ Set Target",
                    adjustSkills: "â€¢ Adjust character skill levels (1-10)",
                    setWeapon: "â€¢ Set weapon breakthrough level (1-90)",
                    autoCalculate: "â€¢ System auto-calculates required materials",
                    inputHoldings: "ğŸ“¦ Input Holdings",
                    inputMaterials: "â€¢ Enter current holdings for each material type",
                    fourTierSystem: "â€¢ Supports four-tier material system",
                    synthesisPath: "â€¢ Greenâ†’Blueâ†’Purpleâ†’Gold synthesis path",
                    smartCalculation: "ğŸ§  Smart Calculation",
                    autoStrategy: "â€¢ Auto-calculates optimal strategy after input",
                    preserveGreen: "â€¢ Ensures green materials aren't over-consumed",
                    maxEfficiency: "â€¢ Maximizes resource utilization efficiency",
                    reportFeature: "ğŸ“‹ Report Feature",
                    detailedStrategy: "â€¢ Detailed synthesis strategy explanation",
                    beforeAfter: "â€¢ Before/after quantity comparison",
                    oneClickCopy: "â€¢ One-click copy complete report",
                    farmingMethods: "âš¡ Farming Methods",
                    normal: "â€¢ Normal (40 stamina/run): Standard Tacet Field",
                    safe: "â€¢ Safe (40 stamina/run): With buffer insurance runs",
                    doubleEvent: "â€¢ Event Double (40 stamina/run): Double drop period",
                    reduced: "â€¢ Reduced Load (80 stamina/run): 2x material drops",
                    recordFeature: "ğŸ’¾ Record Feature",
                    saveSettings: "â€¢ Save current character and weapon settings",
                    quickLoad: "â€¢ Quickly load previous configurations",
                    manageRecords: "â€¢ Manage and delete unwanted records"
                },
                messages: {
                    recordSaved: "âœ… Configuration saved!",
                    recordLoaded: "âœ… Configuration loaded!",
                    recordDeleted: "âœ… Record deleted!",
                    recordsCleared: "âœ… All records cleared!",
                    reportCopied: "âœ… Copied!"
                }
            }
        };

        // Current language
        let currentLanguage = 'zh';

        // Skill upgrade requirements (level 1->2, 2->3, etc.)
        const skillRequirements = {
            1: {green: 2, blue: 0, purple: 0, gold: 0},
            2: {green: 3, blue: 0, purple: 0, gold: 0},
            3: {green: 0, blue: 2, purple: 0, gold: 0},
            4: {green: 0, blue: 3, purple: 0, gold: 0},
            5: {green: 0, blue: 0, purple: 3, gold: 0},
            6: {green: 0, blue: 0, purple: 5, gold: 0},
            7: {green: 0, blue: 0, purple: 0, gold: 2},
            8: {green: 0, blue: 0, purple: 0, gold: 3},
            9: {green: 0, blue: 0, purple: 0, gold: 6}
        };

        // Weapon breakthrough requirements (cumulative from level 1)
        const weaponRequirements = {
            1: {green: 0, blue: 0, purple: 0, gold: 0},
            40: {green: 6, blue: 0, purple: 0, gold: 0},
            50: {green: 6, blue: 8, purple: 0, gold: 0},
            60: {green: 6, blue: 8, purple: 6, gold: 0},
            70: {green: 6, blue: 8, purple: 6, gold: 8},
            80: {green: 6, blue: 8, purple: 6, gold: 20},
            90: {green: 6, blue: 8, purple: 6, gold: 20}
        };

        // Weapon level mapping for slider
        const weaponLevels = [1, 40, 50, 60, 70, 80, 90];

        // Base talent unlock requirements
        const baseTalentRequirements = {
            green: 0,
            blue: 3,
            purple: 15,
            gold: 12
        };

        // Domain drop rates data
        const domainDropRates = {
            stamina: 40,    // æ¯å ´æ¶ˆè€—é«”åŠ›
            green: 6.42,    // å¹³å‡æ¯å ´ç¶ è‰²æ‰è½
            blue: 8.00,     // å¹³å‡æ¯å ´è—è‰²æ‰è½
            purple: 1.59,   // å¹³å‡æ¯å ´ç´«è‰²æ‰è½
            gold: 0.25      // å¹³å‡æ¯å ´é‡‘è‰²æ‰è½
        };

        // User records storage
        let userRecords = JSON.parse(localStorage.getItem('wuthering-waves-records') || '[]');

        // Language functions
        function updateLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('wuthering-waves-language', lang);
            
            // Update document language
            document.documentElement.lang = lang === 'zh' ? 'zh-TW' : 'en';
            
            // Update language button states
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
            
            // Update all text elements with i18n data
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.dataset.i18n;
                const value = getNestedValue(i18nData[lang], key);
                if (value) {
                    element.textContent = value;
                }
            });

            // Update weapon level display
            updateWeaponLevelDisplay();

            // Update placeholder texts
            updatePlaceholders();

            // Re-render records with new language
            renderRecords();

            // Re-perform calculation to update report in new language
            performCalculation();
        }

        function getNestedValue(obj, path) {
            return path.split('.').reduce((current, key) => current && current[key], obj);
        }

        function updateWeaponLevelDisplay() {
            const weaponSlider = document.getElementById('weapon');
            const sliderValue = parseInt(weaponSlider.value);
            const weaponLevel = weaponLevels[sliderValue];
            const suffix = currentLanguage === 'zh' ? 'ç´š' : '';
            document.getElementById('weapon-value').textContent = weaponLevel + suffix;
        }

        function updatePlaceholders() {
            const strategyPlaceholder = getNestedValue(i18nData[currentLanguage], 'strategy.placeholder');
            const reportPlaceholder = getNestedValue(i18nData[currentLanguage], 'report.placeholder');
            const calcPlaceholder = getNestedValue(i18nData[currentLanguage], 'calculation.placeholder');

            if (document.getElementById('strategy-display').querySelector('.bg-gray-50')) {
                document.getElementById('strategy-display').innerHTML = 
                    `<div class="bg-gray-50 rounded-lg p-4 text-center border-2 border-dashed border-gray-300">
                        <p class="card-content text-base">${strategyPlaceholder}</p>
                    </div>`;
            }

            if (document.getElementById('report-content').textContent.includes('è¼¸å…¥æŒæœ‰æ•¸é‡å¾Œ') || 
                document.getElementById('report-content').textContent.includes('Enter current holdings')) {
                document.getElementById('report-content').textContent = reportPlaceholder;
            }

            if (document.getElementById('calculation-process').textContent.includes('é»æ“Šä¸Šæ–¹æŒ‰éˆ•') || 
                document.getElementById('calculation-process').textContent.includes('Click buttons above')) {
                document.getElementById('calculation-process').textContent = calcPlaceholder;
            }
        }

        // Record management functions
        function saveCurrentRecord() {
            const name = prompt(getNestedValue(i18nData[currentLanguage], 'records.savePrompt'), 
                               getNestedValue(i18nData[currentLanguage], 'records.defaultName'));
            if (!name) return;

            const record = {
                id: Date.now(),
                name: name,
                timestamp: new Date().toLocaleString(currentLanguage === 'zh' ? 'zh-TW' : 'en-US'),
                skills: {
                    skill1: parseInt(document.getElementById('skill1').value),
                    skill2: parseInt(document.getElementById('skill2').value),
                    skill3: parseInt(document.getElementById('skill3').value),
                    skill4: parseInt(document.getElementById('skill4').value),
                    skill5: parseInt(document.getElementById('skill5').value)
                },
                weapon: parseInt(document.getElementById('weapon').value),
                materials: {
                    green: parseInt(document.getElementById('current-green').value) || 0,
                    blue: parseInt(document.getElementById('current-blue').value) || 0,
                    purple: parseInt(document.getElementById('current-purple').value) || 0,
                    gold: parseInt(document.getElementById('current-gold').value) || 0
                }
            };

            userRecords.unshift(record);
            // Keep only the latest 10 records
            if (userRecords.length > 10) {
                userRecords = userRecords.slice(0, 10);
            }
            
            localStorage.setItem('wuthering-waves-records', JSON.stringify(userRecords));
            renderRecords();
            
            showMessage(getNestedValue(i18nData[currentLanguage], 'messages.recordSaved'));
        }

        function loadRecord(recordId) {
            const record = userRecords.find(r => r.id === recordId);
            if (!record) return;

            // Load skills
            ['skill1', 'skill2', 'skill3', 'skill4', 'skill5'].forEach(skillId => {
                const value = record.skills[skillId];
                document.getElementById(skillId).value = value;
                document.getElementById(skillId + '-value').textContent = value;
            });

            // Load weapon
            document.getElementById('weapon').value = record.weapon;
            updateWeaponLevelDisplay();
            window.currentWeaponLevel = weaponLevels[record.weapon];

            // Load materials
            ['green', 'blue', 'purple', 'gold'].forEach(color => {
                document.getElementById('current-' + color).value = record.materials[color];
            });

            // Recalculate
            calculateRequirements();
            performCalculation();
            
            showMessage(getNestedValue(i18nData[currentLanguage], 'messages.recordLoaded'));
        }

        function deleteRecord(recordId) {
            if (!confirm(getNestedValue(i18nData[currentLanguage], 'records.deleteRecord'))) return;
            
            userRecords = userRecords.filter(r => r.id !== recordId);
            localStorage.setItem('wuthering-waves-records', JSON.stringify(userRecords));
            renderRecords();
            
            showMessage(getNestedValue(i18nData[currentLanguage], 'messages.recordDeleted'));
        }

        function clearAllRecords() {
            if (!confirm(getNestedValue(i18nData[currentLanguage], 'records.confirmClear'))) return;
            
            userRecords = [];
            localStorage.setItem('wuthering-waves-records', JSON.stringify(userRecords));
            renderRecords();
            
            showMessage(getNestedValue(i18nData[currentLanguage], 'messages.recordsCleared'));
        }

        function renderRecords() {
            const recordsList = document.getElementById('records-list');
            
            if (userRecords.length === 0) {
                recordsList.innerHTML = `<p class="text-gray-500 text-center">${getNestedValue(i18nData[currentLanguage], 'records.empty')}</p>`;
                return;
            }

            recordsList.innerHTML = userRecords.map(record => {
                const skillLevels = [record.skills.skill1, record.skills.skill2, record.skills.skill3, record.skills.skill4, record.skills.skill5];
                const weaponLevel = weaponLevels[record.weapon];
                const suffix = currentLanguage === 'zh' ? 'ç´š' : '';
                
                return `
                    <div class="record-item" onclick="loadRecord(${record.id})">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="font-semibold text-blue-700">${record.name}</div>
                                <div class="text-sm text-gray-600">
                                    ${currentLanguage === 'zh' ? 'æŠ€èƒ½' : 'Skills'}: [${skillLevels.join(', ')}] | 
                                    ${currentLanguage === 'zh' ? 'æ­¦å™¨' : 'Weapon'}: ${weaponLevel}${suffix} | 
                                    ${currentLanguage === 'zh' ? 'ç´ æ' : 'Materials'}: ğŸŸ¢${record.materials.green} ğŸ”µ${record.materials.blue} ğŸŸ£${record.materials.purple} ğŸŸ¡${record.materials.gold}
                                </div>
                                <div class="text-xs text-gray-500">${record.timestamp}</div>
                            </div>
                            <button class="record-delete text-red-500 hover:text-red-700 ml-4 p-1" 
                                    onclick="event.stopPropagation(); deleteRecord(${record.id})">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showMessage(message) {
            // Create temporary message display
            const messageEl = document.createElement('div');
            messageEl.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
            messageEl.textContent = message;
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.remove();
            }, 2000);
        }

        // Verification function for AI self-check
        function verifyRuns(n, requiredGold) {
            const directGold = 0.25 * n;
            const green = 6.42 * n, blue = 8 * n, purple = 1.59 * n;
            const synthBlue = Math.floor(green / 3);
            const synthPurple = Math.floor((blue + synthBlue) / 3);
            const synthGold = Math.floor((purple + synthPurple) / 3);
            return (directGold + synthGold) >= requiredGold;
        }

        // New dynamic domain calculation algorithm
        function calculateDomainRuns(shortageGold, currentMaterials) {
            // å‡ç´ é ˜åŸŸå›ºå®šæ‰è½ç‡
            const DROP_RATES = {
                green: 6.42,
                blue: 8.00,
                purple: 1.59,
                gold: 0.25
            };

            // è¨ˆç®—æœ€å°å ´æ¬¡ï¼ˆè€ƒæ…®ç›´æ¥æ‰è½+ä¸‰éšåˆæˆï¼‰
            function calculateMinRuns() {
                let runs = 0;
                while (true) {
                    // ç›´æ¥ç²å–
                    const directGold = runs * DROP_RATES.gold;
                    
                    // åˆæˆç²å–ï¼ˆå®Œæ•´ä¸‰éšè½‰æ›ï¼‰
                    const synthGold = 
                        Math.floor((
                            (runs * DROP_RATES.purple) + 
                            Math.floor((
                                (runs * DROP_RATES.blue) + 
                                Math.floor((runs * DROP_RATES.green) / 3)
                            ) / 3)
                        ) / 3);
                    
                    if (directGold + synthGold >= shortageGold) {
                        return runs;
                    }
                    runs++;
                }
            }

            // è³‡æºæ¶ˆè€—é©—è­‰
            function verifyResources(runs) {
                const requiredGreen = Math.ceil(shortageGold / (DROP_RATES.gold + DROP_RATES.green/27));
                return {
                    green: runs * DROP_RATES.green <= currentMaterials.green + requiredGreen,
                    blue: runs * DROP_RATES.blue <= currentMaterials.blue + Math.floor(runs * DROP_RATES.green / 3),
                    purple: runs * DROP_RATES.purple <= currentMaterials.purple + Math.floor(runs * DROP_RATES.blue / 3)
                };
            }

            const minRuns = calculateMinRuns();
            
            // æ™ºèƒ½ç·©è¡æ©Ÿåˆ¶
            let bufferRate = 0.1; // åŸºç¤10%ç·©è¡
            if (shortageGold > 30) {
                bufferRate = 0.15; // å¤§ç¼ºå£15%ç·©è¡
            } else if (shortageGold <= 20) {
                bufferRate = 0.08; // å°ç¼ºå£8%ç·©è¡
            }
            
            const safeRuns = Math.ceil(minRuns * (1 + bufferRate));
            
            // è¨ˆç®—æ•ˆç‡æŒ‡æ¨™
            const directGold = minRuns * DROP_RATES.gold;
            const synthGold = Math.floor((
                (minRuns * DROP_RATES.purple) + 
                Math.floor((
                    (minRuns * DROP_RATES.blue) + 
                    Math.floor((minRuns * DROP_RATES.green) / 3)
                ) / 3)
            ) / 3);
            const totalEfficiency = (directGold + synthGold) / minRuns;
            
            return {
                minRuns,
                safeRuns,
                stamina: minRuns * 40,
                resourceCheck: verifyResources(minRuns),
                efficiency: totalEfficiency,
                directGold: directGold,
                synthGold: synthGold,
                totalGold: directGold + synthGold,
                bufferRate: bufferRate
            };
        }

        // Legacy function wrapper for compatibility
        function calculateOptimalDomainRuns(required) {
            // If no gold needed, use simple calculation
            if (required.gold === 0) {
                const greenRuns = required.green > 0 ? Math.ceil(required.green / domainDropRates.green) : 0;
                const blueRuns = required.blue > 0 ? Math.ceil(required.blue / domainDropRates.blue) : 0;
                const purpleRuns = required.purple > 0 ? Math.ceil(required.purple / domainDropRates.purple) : 0;
                const runs = Math.max(greenRuns, blueRuns, purpleRuns);
                
                return {
                    runs: runs,
                    stamina: runs * domainDropRates.stamina,
                    directGold: runs * domainDropRates.gold,
                    synthesisPath: runs > 0 ? "ç„¡éœ€é‡‘è‰²ç´ æåˆæˆ" : "ç„¡éœ€åˆ·å–",
                    totalGold: runs * domainDropRates.gold,
                    synthGold: 0,
                    oldMethodRuns: runs,
                    remaining: {
                        green: Math.max(0, runs * domainDropRates.green - required.green),
                        blue: Math.max(0, runs * domainDropRates.blue - required.blue),
                        purple: Math.max(0, runs * domainDropRates.purple - required.purple)
                    }
                };
            }

            // Use new dynamic algorithm for gold requirements
            const currentMaterials = {
                green: parseInt(document.getElementById('current-green').value) || 0,
                blue: parseInt(document.getElementById('current-blue').value) || 0,
                purple: parseInt(document.getElementById('current-purple').value) || 0,
                gold: parseInt(document.getElementById('current-gold').value) || 0
            };

            const domainResult = calculateDomainRuns(required.gold, currentMaterials);
            
            return {
                runs: domainResult.minRuns,
                safeRuns: domainResult.safeRuns,
                stamina: domainResult.stamina,
                directGold: domainResult.directGold,
                synthGold: domainResult.synthGold,
                totalGold: domainResult.totalGold,
                efficiency: domainResult.efficiency,
                resourceCheck: domainResult.resourceCheck,
                bufferRate: domainResult.bufferRate
            };
        }

        // Initialize sliders and buttons
        function initializeSliders() {
            const sliders = ['skill1', 'skill2', 'skill3', 'skill4', 'skill5'];
            sliders.forEach(id => {
                const slider = document.getElementById(id);
                const valueDisplay = document.getElementById(id + '-value');
                
                slider.addEventListener('input', function() {
                    valueDisplay.textContent = this.value;
                    calculateRequirements();
                });
            });

            // Initialize weapon slider
            const weaponSlider = document.getElementById('weapon');
            const weaponValueDisplay = document.getElementById('weapon-value');
            
            weaponSlider.addEventListener('input', function() {
                const sliderValue = parseInt(this.value);
                const weaponLevel = weaponLevels[sliderValue];
                const suffix = currentLanguage === 'zh' ? 'ç´š' : '';
                weaponValueDisplay.textContent = weaponLevel + suffix;
                window.currentWeaponLevel = weaponLevel;
                calculateRequirements();
            });

            // Initialize skill level quick buttons
            document.getElementById('skill-level-6').addEventListener('click', function() {
                setAllSkillLevels(6);
            });
            document.getElementById('skill-level-8').addEventListener('click', function() {
                setAllSkillLevels(8);
            });
            document.getElementById('skill-level-10').addEventListener('click', function() {
                setAllSkillLevels(10);
            });

            // Initialize current holdings inputs with auto-calculation
            const inputs = ['current-green', 'current-blue', 'current-purple', 'current-gold'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    updateStatusTable();
                    // Auto-trigger calculation after a short delay
                    clearTimeout(window.autoCalculateTimeout);
                    window.autoCalculateTimeout = setTimeout(() => {
                        performCalculation();
                    }, 500);
                });
            });

            // Initialize language buttons
            document.getElementById('lang-zh').addEventListener('click', function() {
                updateLanguage('zh');
            });
            document.getElementById('lang-en').addEventListener('click', function() {
                updateLanguage('en');
            });

            // Initialize record buttons
            document.getElementById('save-record-btn').addEventListener('click', saveCurrentRecord);
            document.getElementById('clear-records-btn').addEventListener('click', clearAllRecords);
        }

        // Set all skill levels to a specific value
        function setAllSkillLevels(level) {
            ['skill1', 'skill2', 'skill3', 'skill4', 'skill5'].forEach(id => {
                document.getElementById(id).value = level;
                document.getElementById(id + '-value').textContent = level;
            });
            calculateRequirements();
        }

        // Set weapon level
        function setWeaponLevel(level) {
            const sliderIndex = weaponLevels.indexOf(level);
            if (sliderIndex !== -1) {
                document.getElementById('weapon').value = sliderIndex;
                updateWeaponLevelDisplay();
                window.currentWeaponLevel = level;
                calculateRequirements();
            }
        }

        // Calculate total requirements based on current settings
        function calculateRequirements() {
            let totalReq = {
                green: baseTalentRequirements.green,
                blue: baseTalentRequirements.blue,
                purple: baseTalentRequirements.purple,
                gold: baseTalentRequirements.gold
            };

            // Add skill requirements
            for (let i = 1; i <= 5; i++) {
                const level = parseInt(document.getElementById(`skill${i}`).value);
                for (let l = 1; l < level; l++) {
                    if (skillRequirements[l]) {
                        totalReq.green += skillRequirements[l].green;
                        totalReq.blue += skillRequirements[l].blue;
                        totalReq.purple += skillRequirements[l].purple;
                        totalReq.gold += skillRequirements[l].gold;
                    }
                }
            }

            // Add weapon requirements
            const weaponLevel = window.currentWeaponLevel || 1;
            if (weaponRequirements[weaponLevel]) {
                totalReq.green += weaponRequirements[weaponLevel].green;
                totalReq.blue += weaponRequirements[weaponLevel].blue;
                totalReq.purple += weaponRequirements[weaponLevel].purple;
                totalReq.gold += weaponRequirements[weaponLevel].gold;
            }

            // Update display
            document.getElementById('target-green').textContent = totalReq.green;
            document.getElementById('target-blue').textContent = totalReq.blue;
            document.getElementById('target-purple').textContent = totalReq.purple;
            document.getElementById('target-gold').textContent = totalReq.gold;

            updateStatusTable();
            
            // å³æ™‚æ›´æ–°åˆæˆç­–ç•¥å’ŒåŸ·è¡Œé è¦½
            performCalculation();
            
            return totalReq;
        }

        // Update status table
        function updateStatusTable() {
            const targets = {
                green: parseInt(document.getElementById('target-green').textContent),
                blue: parseInt(document.getElementById('target-blue').textContent),
                purple: parseInt(document.getElementById('target-purple').textContent),
                gold: parseInt(document.getElementById('target-gold').textContent)
            };

            const current = {
                green: parseInt(document.getElementById('current-green').value) || 0,
                blue: parseInt(document.getElementById('current-blue').value) || 0,
                purple: parseInt(document.getElementById('current-purple').value) || 0,
                gold: parseInt(document.getElementById('current-gold').value) || 0
            };

            const colors = ['green', 'blue', 'purple', 'gold'];
            colors.forEach(color => {
                document.getElementById(`status-target-${color}`).textContent = targets[color];
                document.getElementById(`status-current-${color}`).textContent = current[color];
                
                const diff = current[color] - targets[color];
                const statusEl = document.getElementById(`status-${color}`);
                
                if (diff >= 0) {
                    statusEl.innerHTML = `<span class="status-success">âœ“ +${diff}</span>`;
                } else {
                    statusEl.innerHTML = `<span class="status-error">âœ— ${diff}</span>`;
                }
            });
        }

        // Reverse algorithm calculation
        function calculateOptimalStrategy() {
            const targets = {
                green: parseInt(document.getElementById('target-green').textContent),
                blue: parseInt(document.getElementById('target-blue').textContent),
                purple: parseInt(document.getElementById('target-purple').textContent),
                gold: parseInt(document.getElementById('target-gold').textContent)
            };

            const current = {
                green: parseInt(document.getElementById('current-green').value) || 0,
                blue: parseInt(document.getElementById('current-blue').value) || 0,
                purple: parseInt(document.getElementById('current-purple').value) || 0,
                gold: parseInt(document.getElementById('current-gold').value) || 0
            };

            // Reverse algorithm implementation
            let strategy = [];
            let finalAmounts = {...current};

            // Step 1: Calculate gold deficit and required purple
            const goldDeficit = Math.max(0, targets.gold - current.gold);
            const purpleNeededForGold = goldDeficit * 3;

            // Step 2: Calculate total purple requirement
            const totalPurpleNeeded = targets.purple + purpleNeededForGold;
            const purpleDeficit = Math.max(0, totalPurpleNeeded - current.purple);
            const blueNeededForPurple = purpleDeficit * 3;

            // Step 3: Calculate total blue requirement
            const totalBlueNeeded = targets.blue + blueNeededForPurple;
            const blueDeficit = Math.max(0, totalBlueNeeded - current.blue);
            const greenNeededForBlue = blueDeficit * 3;

            // Step 4: Calculate available green (must preserve target amount)
            const availableGreen = Math.max(0, current.green - targets.green);

            // Step 5: Execute synthesis strategy
            // Green -> Blue synthesis
            const greenToBlueSynthesis = Math.min(Math.floor(availableGreen / 3), blueDeficit);
            if (greenToBlueSynthesis > 0) {
                const synthText = currentLanguage === 'zh' ? 
                    `ç¶ â†’è—åˆæˆ: ${greenToBlueSynthesis} æ¬¡ (æ¶ˆè€— ${greenToBlueSynthesis * 3} ç¶ è‰² â†’ ç²å¾— ${greenToBlueSynthesis} è—è‰²)` :
                    `Greenâ†’Blue Synthesis: ${greenToBlueSynthesis} times (Consume ${greenToBlueSynthesis * 3} Green â†’ Get ${greenToBlueSynthesis} Blue)`;
                strategy.push(synthText);
                finalAmounts.green -= greenToBlueSynthesis * 3;
                finalAmounts.blue += greenToBlueSynthesis;
            }

            // Blue -> Purple synthesis
            const availableBlue = finalAmounts.blue - targets.blue;
            const blueToPurpleSynthesis = Math.min(Math.floor(Math.max(0, availableBlue) / 3), purpleDeficit);
            if (blueToPurpleSynthesis > 0) {
                const synthText = currentLanguage === 'zh' ? 
                    `è—â†’ç´«åˆæˆ: ${blueToPurpleSynthesis} æ¬¡ (æ¶ˆè€— ${blueToPurpleSynthesis * 3} è—è‰² â†’ ç²å¾— ${blueToPurpleSynthesis} ç´«è‰²)` :
                    `Blueâ†’Purple Synthesis: ${blueToPurpleSynthesis} times (Consume ${blueToPurpleSynthesis * 3} Blue â†’ Get ${blueToPurpleSynthesis} Purple)`;
                strategy.push(synthText);
                finalAmounts.blue -= blueToPurpleSynthesis * 3;
                finalAmounts.purple += blueToPurpleSynthesis;
            }

            // Purple -> Gold synthesis
            const availablePurple = finalAmounts.purple - targets.purple;
            const purpleToGoldSynthesis = Math.min(Math.floor(Math.max(0, availablePurple) / 3), goldDeficit);
            if (purpleToGoldSynthesis > 0) {
                const synthText = currentLanguage === 'zh' ? 
                    `ç´«â†’é‡‘åˆæˆ: ${purpleToGoldSynthesis} æ¬¡ (æ¶ˆè€— ${purpleToGoldSynthesis * 3} ç´«è‰² â†’ ç²å¾— ${purpleToGoldSynthesis} é‡‘è‰²)` :
                    `Purpleâ†’Gold Synthesis: ${purpleToGoldSynthesis} times (Consume ${purpleToGoldSynthesis * 3} Purple â†’ Get ${purpleToGoldSynthesis} Gold)`;
                strategy.push(synthText);
                finalAmounts.purple -= purpleToGoldSynthesis * 3;
                finalAmounts.gold += purpleToGoldSynthesis;
            }

            return {strategy, finalAmounts, targets, current};
        }

        // Generate calculation process details
        function generateCalculationProcess(calculation) {
            const {strategy, finalAmounts, targets, current} = calculation;
            const now = new Date().toLocaleString(currentLanguage === 'zh' ? 'zh-TW' : 'en-US');

            let process = currentLanguage === 'zh' ? 
                `ğŸ” è¨ˆç®—éç¨‹è©³æƒ…\nè¨ˆç®—æ™‚é–“: ${now}\n\n` :
                `ğŸ” Calculation Process Details\nCalculation Time: ${now}\n\n`;

            // 1. åˆå§‹ç‹€æ…‹
            if (currentLanguage === 'zh') {
                process += `ğŸ“Š åˆå§‹ç‹€æ…‹:\n`;
                process += `ç›®æ¨™éœ€æ±‚: ç¶ ${targets.green} è—${targets.blue} ç´«${targets.purple} é‡‘${targets.gold}\n`;
                process += `ç•¶å‰æŒæœ‰: ç¶ ${current.green} è—${current.blue} ç´«${current.purple} é‡‘${current.gold}\n\n`;
            } else {
                process += `ğŸ“Š Initial State:\n`;
                process += `Target Requirements: Green${targets.green} Blue${targets.blue} Purple${targets.purple} Gold${targets.gold}\n`;
                process += `Current Holdings: Green${current.green} Blue${current.blue} Purple${current.purple} Gold${current.gold}\n\n`;
            }

            // 2. é€†å‘æ¼”ç®—æ³•è¨ˆç®—éç¨‹
            const goldDeficit = Math.max(0, targets.gold - current.gold);
            if (currentLanguage === 'zh') {
                process += `ğŸ§® é€†å‘æ¼”ç®—æ³•è¨ˆç®—:\n`;
                process += `æ­¥é©Ÿ1 - é‡‘è‰²ç´ æåˆ†æ:\n`;
                process += `  é‡‘è‰²ç¼ºå£ = max(0, ${targets.gold} - ${current.gold}) = ${goldDeficit}\n`;
            } else {
                process += `ğŸ§® Reverse Algorithm Calculation:\n`;
                process += `Step 1 - Gold Material Analysis:\n`;
                process += `  Gold Deficit = max(0, ${targets.gold} - ${current.gold}) = ${goldDeficit}\n`;
            }
            
            if (goldDeficit > 0) {
                const purpleNeededForGold = goldDeficit * 3;
                if (currentLanguage === 'zh') {
                    process += `  åˆæˆé‡‘è‰²éœ€è¦ç´«è‰² = ${goldDeficit} Ã— 3 = ${purpleNeededForGold}\n`;
                } else {
                    process += `  Purple needed for Gold synthesis = ${goldDeficit} Ã— 3 = ${purpleNeededForGold}\n`;
                }
                
                // Step 2: Purple calculation
                const totalPurpleNeeded = targets.purple + purpleNeededForGold;
                const purpleDeficit = Math.max(0, totalPurpleNeeded - current.purple);
                if (currentLanguage === 'zh') {
                    process += `æ­¥é©Ÿ2 - ç´«è‰²ç´ æåˆ†æ:\n`;
                    process += `  ç´«è‰²ç¸½éœ€æ±‚ = ${targets.purple} + ${purpleNeededForGold} = ${totalPurpleNeeded}\n`;
                    process += `  ç´«è‰²ç¼ºå£ = max(0, ${totalPurpleNeeded} - ${current.purple}) = ${purpleDeficit}\n`;
                } else {
                    process += `Step 2 - Purple Material Analysis:\n`;
                    process += `  Total Purple needed = ${targets.purple} + ${purpleNeededForGold} = ${totalPurpleNeeded}\n`;
                    process += `  Purple deficit = max(0, ${totalPurpleNeeded} - ${current.purple}) = ${purpleDeficit}\n`;
                }
                
                if (purpleDeficit > 0) {
                    const blueNeededForPurple = purpleDeficit * 3;
                    if (currentLanguage === 'zh') {
                        process += `  åˆæˆç´«è‰²éœ€è¦è—è‰² = ${purpleDeficit} Ã— 3 = ${blueNeededForPurple}\n`;
                    } else {
                        process += `  Blue needed for Purple synthesis = ${purpleDeficit} Ã— 3 = ${blueNeededForPurple}\n`;
                    }
                    
                    // Step 3: Blue calculation
                    const totalBlueNeeded = targets.blue + blueNeededForPurple;
                    const blueDeficit = Math.max(0, totalBlueNeeded - current.blue);
                    if (currentLanguage === 'zh') {
                        process += `æ­¥é©Ÿ3 - è—è‰²ç´ æåˆ†æ:\n`;
                        process += `  è—è‰²ç¸½éœ€æ±‚ = ${targets.blue} + ${blueNeededForPurple} = ${totalBlueNeeded}\n`;
                        process += `  è—è‰²ç¼ºå£ = max(0, ${totalBlueNeeded} - ${current.blue}) = ${blueDeficit}\n`;
                    } else {
                        process += `Step 3 - Blue Material Analysis:\n`;
                        process += `  Total Blue needed = ${targets.blue} + ${blueNeededForPurple} = ${totalBlueNeeded}\n`;
                        process += `  Blue deficit = max(0, ${totalBlueNeeded} - ${current.blue}) = ${blueDeficit}\n`;
                    }
                    
                    if (blueDeficit > 0) {
                        const greenNeededForBlue = blueDeficit * 3;
                        const availableGreen = Math.max(0, current.green - targets.green);
                        if (currentLanguage === 'zh') {
                            process += `æ­¥é©Ÿ4 - ç¶ è‰²ç´ æåˆ†æ:\n`;
                            process += `  åˆæˆè—è‰²éœ€è¦ç¶ è‰² = ${blueDeficit} Ã— 3 = ${greenNeededForBlue}\n`;
                            process += `  å¯ç”¨ç¶ è‰² = max(0, ${current.green} - ${targets.green}) = ${availableGreen}\n`;
                            process += `  ç¶ è‰²åˆæˆèƒ½åŠ› = min(${Math.floor(availableGreen / 3)}, ${blueDeficit}) = ${Math.min(Math.floor(availableGreen / 3), blueDeficit)}\n`;
                        } else {
                            process += `Step 4 - Green Material Analysis:\n`;
                            process += `  Green needed for Blue synthesis = ${blueDeficit} Ã— 3 = ${greenNeededForBlue}\n`;
                            process += `  Available Green = max(0, ${current.green} - ${targets.green}) = ${availableGreen}\n`;
                            process += `  Green synthesis capacity = min(${Math.floor(availableGreen / 3)}, ${blueDeficit}) = ${Math.min(Math.floor(availableGreen / 3), blueDeficit)}\n`;
                        }
                    }
                }
            } else {
                if (currentLanguage === 'zh') {
                    process += `  ç„¡éœ€é‡‘è‰²ç´ æï¼Œè·³éå¾ŒçºŒè¨ˆç®—\n`;
                } else {
                    process += `  No gold materials needed, skip subsequent calculations\n`;
                }
            }

            process += `\n`;

            // 3. åˆæˆåŸ·è¡Œéç¨‹
            if (strategy.length > 0) {
                if (currentLanguage === 'zh') {
                    process += `âš™ï¸ åˆæˆåŸ·è¡Œéç¨‹:\n`;
                } else {
                    process += `âš™ï¸ Synthesis Execution Process:\n`;
                }
                let tempAmounts = {...current};
                
                strategy.forEach((step, index) => {
                    if (currentLanguage === 'zh') {
                        process += `åŸ·è¡Œæ­¥é©Ÿ ${index + 1}: ${step}\n`;
                    } else {
                        process += `Execution Step ${index + 1}: ${step}\n`;
                    }
                    
                    if (step.includes('ç¶ â†’è—') || step.includes('Greenâ†’Blue')) {
                        const matches = step.match(/(\d+)/g);
                        if (matches && matches.length >= 3) {
                            const times = parseInt(matches[0]);
                            const greenUsed = parseInt(matches[1]);
                            const blueGained = parseInt(matches[2]);
                            tempAmounts.green -= greenUsed;
                            tempAmounts.blue += blueGained;
                            if (currentLanguage === 'zh') {
                                process += `  åŸ·è¡Œå¾Œ: ç¶ ${tempAmounts.green} è—${tempAmounts.blue}\n`;
                            } else {
                                process += `  After execution: Green${tempAmounts.green} Blue${tempAmounts.blue}\n`;
                            }
                        }
                    } else if (step.includes('è—â†’ç´«') || step.includes('Blueâ†’Purple')) {
                        const matches = step.match(/(\d+)/g);
                        if (matches && matches.length >= 3) {
                            const times = parseInt(matches[0]);
                            const blueUsed = parseInt(matches[1]);
                            const purpleGained = parseInt(matches[2]);
                            tempAmounts.blue -= blueUsed;
                            tempAmounts.purple += purpleGained;
                            if (currentLanguage === 'zh') {
                                process += `  åŸ·è¡Œå¾Œ: è—${tempAmounts.blue} ç´«${tempAmounts.purple}\n`;
                            } else {
                                process += `  After execution: Blue${tempAmounts.blue} Purple${tempAmounts.purple}\n`;
                            }
                        }
                    } else if (step.includes('ç´«â†’é‡‘') || step.includes('Purpleâ†’Gold')) {
                        const matches = step.match(/(\d+)/g);
                        if (matches && matches.length >= 3) {
                            const times = parseInt(matches[0]);
                            const purpleUsed = parseInt(matches[1]);
                            const goldGained = parseInt(matches[2]);
                            tempAmounts.purple -= purpleUsed;
                            tempAmounts.gold += goldGained;
                            if (currentLanguage === 'zh') {
                                process += `  åŸ·è¡Œå¾Œ: ç´«${tempAmounts.purple} é‡‘${tempAmounts.gold}\n`;
                            } else {
                                process += `  After execution: Purple${tempAmounts.purple} Gold${tempAmounts.gold}\n`;
                            }
                        }
                    }
                });
            } else {
                if (currentLanguage === 'zh') {
                    process += `âš™ï¸ ç„¡éœ€åŸ·è¡Œåˆæˆæ“ä½œ\n`;
                } else {
                    process += `âš™ï¸ No synthesis operations needed\n`;
                }
            }

            process += `\n`;

            // 4. æœ€çµ‚çµæœé©—è­‰
            if (currentLanguage === 'zh') {
                process += `âœ… æœ€çµ‚çµæœé©—è­‰:\n`;
                process += `åˆæˆå¾ŒæŒæœ‰: ç¶ ${Math.floor(finalAmounts.green)} è—${Math.floor(finalAmounts.blue)} ç´«${Math.floor(finalAmounts.purple)} é‡‘${Math.floor(finalAmounts.gold)}\n`;
                process += `ç›®æ¨™éœ€æ±‚: ç¶ ${targets.green} è—${targets.blue} ç´«${targets.purple} é‡‘${targets.gold}\n`;
            } else {
                process += `âœ… Final Result Verification:\n`;
                process += `After synthesis: Green${Math.floor(finalAmounts.green)} Blue${Math.floor(finalAmounts.blue)} Purple${Math.floor(finalAmounts.purple)} Gold${Math.floor(finalAmounts.gold)}\n`;
                process += `Target requirements: Green${targets.green} Blue${targets.blue} Purple${targets.purple} Gold${targets.gold}\n`;
            }
            
            const finalShortages = {
                green: Math.max(0, targets.green - finalAmounts.green),
                blue: Math.max(0, targets.blue - finalAmounts.blue),
                purple: Math.max(0, targets.purple - finalAmounts.purple),
                gold: Math.max(0, targets.gold - finalAmounts.gold)
            };
            
            if (currentLanguage === 'zh') {
                process += `å‰©é¤˜ç¼ºå£: ç¶ ${finalShortages.green} è—${finalShortages.blue} ç´«${finalShortages.purple} é‡‘${finalShortages.gold}\n`;
            } else {
                process += `Remaining deficit: Green${finalShortages.green} Blue${finalShortages.blue} Purple${finalShortages.purple} Gold${finalShortages.gold}\n`;
            }

            return process;
        }

        // Generate simplified report
        function generateReport(calculation) {
            const {strategy, finalAmounts, targets, current} = calculation;
            const now = new Date().toLocaleString(currentLanguage === 'zh' ? 'zh-TW' : 'en-US');

            // è¨ˆç®—ç´ æç¼ºå£ï¼ˆåœ¨å ±å‘Šé–‹å§‹å°±è¨ˆç®—ï¼‰
            const shortages = {
                green: Math.max(0, targets.green - finalAmounts.green),
                blue: Math.max(0, targets.blue - finalAmounts.blue),
                purple: Math.max(0, targets.purple - finalAmounts.purple),
                gold: Math.max(0, targets.gold - finalAmounts.gold)
            };

            let report = currentLanguage === 'zh' ?
                `ğŸ¯ ç´ æéœ€æ±‚åˆ†æå ±å‘Š\nç”Ÿæˆæ™‚é–“: ${now}\n\n` :
                `ğŸ¯ Material Requirement Analysis Report\nGeneration Time: ${now}\n\n`;

            // 1. è³‡æºç‹€æ…‹ - ç°¡åŒ–é¡¯ç¤º
            if (currentLanguage === 'zh') {
                report += `ğŸ“Š è³‡æºç‹€æ…‹\n`;
            } else {
                report += `ğŸ“Š Resource Status\n`;
            }

            const colors = [
                {name: 'ğŸŸ¢ç¶ ', key: 'green', nameEn: 'ğŸŸ¢Green'},
                {name: 'ğŸ”µè—', key: 'blue', nameEn: 'ğŸ”µBlue'}, 
                {name: 'ğŸŸ£ç´«', key: 'purple', nameEn: 'ğŸŸ£Purple'},
                {name: 'ğŸŸ¡é‡‘', key: 'gold', nameEn: 'ğŸŸ¡Gold'}
            ];

            let statusLine = '';
            colors.forEach(({name, key, nameEn}) => {
                const diff = current[key] - targets[key];
                const displayName = currentLanguage === 'zh' ? name : nameEn;
                if (diff >= 0) {
                    statusLine += `${displayName}âœ“ `;
                } else {
                    const deficitText = currentLanguage === 'zh' ? 'ç¼º' : 'need';
                    statusLine += `${displayName}${deficitText}${Math.abs(diff)} `;
                }
            });
            report += statusLine + '\n\n';

            // 2. åˆæˆç­–ç•¥ - ç°¡åŒ–é¡¯ç¤º
            if (strategy.length === 0) {
                // æª¢æŸ¥æ˜¯å¦æœ‰ä»»ä½•ç´ æç¼ºå£
                const hasAnyShortage = Object.values(shortages).some(shortage => shortage > 0);
                if (hasAnyShortage) {
                    if (currentLanguage === 'zh') {
                        report += `ğŸ”„ ç„¡éœ€åˆæˆ\n\n`;
                    } else {
                        report += `ğŸ”„ No synthesis needed\n\n`;
                    }
                } else {
                    if (currentLanguage === 'zh') {
                        report += `âœ… ç„¡éœ€åˆæˆï¼Œè³‡æºå·²è¶³å¤ \n\n`;
                    } else {
                        report += `âœ… No synthesis needed, resources are sufficient\n\n`;
                    }
                }
            } else {
                if (currentLanguage === 'zh') {
                    report += `ğŸ”„ åˆæˆç­–ç•¥\n`;
                } else {
                    report += `ğŸ”„ Synthesis Strategy\n`;
                }
                strategy.forEach((step, index) => {
                    if (currentLanguage === 'zh') {
                        if (step.includes('ç¶ â†’è—')) {
                            const matches = step.match(/(\d+) ç¶ è‰².*?(\d+) è—è‰²/);
                            if (matches) report += `â€¢ ç”¨${matches[1]}ç¶  â†’ å¾—${matches[2]}è—\n`;
                        } else if (step.includes('è—â†’ç´«')) {
                            const matches = step.match(/(\d+) è—è‰².*?(\d+) ç´«è‰²/);
                            if (matches) report += `â€¢ ç”¨${matches[1]}è— â†’ å¾—${matches[2]}ç´«\n`;
                        } else if (step.includes('ç´«â†’é‡‘')) {
                            const matches = step.match(/(\d+) ç´«è‰².*?(\d+) é‡‘è‰²/);
                            if (matches) report += `â€¢ ç”¨${matches[1]}ç´« â†’ å¾—${matches[2]}é‡‘\n`;
                        }
                    } else {
                        if (step.includes('Greenâ†’Blue')) {
                            const matches = step.match(/(\d+) Green.*?(\d+) Blue/);
                            if (matches) report += `â€¢ Use ${matches[1]}Green â†’ Get ${matches[2]}Blue\n`;
                        } else if (step.includes('Blueâ†’Purple')) {
                            const matches = step.match(/(\d+) Blue.*?(\d+) Purple/);
                            if (matches) report += `â€¢ Use ${matches[1]}Blue â†’ Get ${matches[2]}Purple\n`;
                        } else if (step.includes('Purpleâ†’Gold')) {
                            const matches = step.match(/(\d+) Purple.*?(\d+) Gold/);
                            if (matches) report += `â€¢ Use ${matches[1]}Purple â†’ Get ${matches[2]}Gold\n`;
                        }
                    }
                });
                report += '\n';
            }

            // 3. å‡ç´ é ˜åŸŸå»ºè­° - åŒ…å«æ¸›è² é€”å¾‘å’Œæ´»å‹•å»ºè­°
            if (shortages.gold === 0 && shortages.purple === 0 && shortages.blue === 0 && shortages.green === 0) {
                if (currentLanguage === 'zh') {
                    report += `ğŸ‰ å®Œç¾ï¼ç„¡éœ€åˆ·å–å‡ç´ é ˜åŸŸ\n`;
                } else {
                    report += `ğŸ‰ Perfect! No need to farm Tacet Fields\n`;
                }
            } else {
                if (currentLanguage === 'zh') {
                    report += `âš¡ å‡ç´ é ˜åŸŸå»ºè­°\n`;
                } else {
                    report += `âš¡ Tacet Field Recommendations\n`;
                }
                
                if (shortages.gold > 0) {
                    const domainResult = calculateDomainRuns(shortages.gold, current);
                    if (currentLanguage === 'zh') {
                        report += `ç¼ºå£: ${shortages.gold}é‡‘\n`;
                    } else {
                        report += `Deficit: ${shortages.gold} Gold\n`;
                    }
                    
                    // è¨ˆç®—æ´»å‹•é›™å€æ‰è½å»ºè­°
                    const doubleDropRuns = Math.ceil(domainResult.minRuns / 2);
                    const dailyLimit = 3;
                    const doubleDropDays = Math.ceil(doubleDropRuns / dailyLimit);
                    
                    // è¨ˆç®—æ¸›è² é€”å¾‘å»ºè­°
                    const reducedRuns = Math.ceil(domainResult.minRuns / 2);
                    
                    if (currentLanguage === 'zh') {
                        report += `\nğŸ“‹ åˆ·å–æ–¹æ¡ˆ:\n`;
                        report += `â€¢ å¸¸è¦(40é«”/å ´): ${domainResult.minRuns}å ´ (${domainResult.minRuns * 40}é«”åŠ›) - ç†è«–æœ€å°‘å ´æ¬¡\n`;
                        report += `â€¢ å®‰å…¨(40é«”/å ´): ${domainResult.safeRuns}å ´ (${domainResult.safeRuns * 40}é«”åŠ›) - å«ç·©è¡ä¿éšª\n`;
                        
                        if (doubleDropRuns <= dailyLimit) {
                            report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${doubleDropRuns}å ´ (${doubleDropRuns * 40}é«”åŠ›) - 1å¤©å…§å®Œæˆ\n`;
                        } else {
                            const remainingRuns = domainResult.minRuns - (dailyLimit * 2 * doubleDropDays);
                            if (remainingRuns > 0) {
                                report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${dailyLimit}å ´Ã—${doubleDropDays}å¤© + å¸¸è¦${remainingRuns}å ´\n`;
                                report += `  ç¸½è¨ˆ: ${(dailyLimit * doubleDropDays * 40) + (remainingRuns * 40)}é«”åŠ›\n`;
                            } else {
                                report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${dailyLimit}å ´Ã—${doubleDropDays}å¤© (${dailyLimit * doubleDropDays * 40}é«”åŠ›)\n`;
                            }
                        }
                        
                        report += `â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): ${reducedRuns}å ´ (${reducedRuns * 80}é«”åŠ›) - 2å€ç´ ææ‰è½\n`;
                    } else {
                        report += `\nğŸ“‹ Farming Options:\n`;
                        report += `â€¢ Normal(40 stamina/run): ${domainResult.minRuns} runs (${domainResult.minRuns * 40} stamina) - Theoretical minimum\n`;
                        report += `â€¢ Safe(40 stamina/run): ${domainResult.safeRuns} runs (${domainResult.safeRuns * 40} stamina) - With buffer insurance\n`;
                        
                        if (doubleDropRuns <= dailyLimit) {
                            report += `â€¢ Event Double(40 stamina/run): ${doubleDropRuns} runs (${doubleDropRuns * 40} stamina) - Complete in 1 day\n`;
                        } else {
                            const remainingRuns = domainResult.minRuns - (dailyLimit * 2 * doubleDropDays);
                            if (remainingRuns > 0) {
                                report += `â€¢ Event Double(40 stamina/run): ${dailyLimit} runsÃ—${doubleDropDays} days + Normal ${remainingRuns} runs\n`;
                                report += `  Total: ${(dailyLimit * doubleDropDays * 40) + (remainingRuns * 40)} stamina\n`;
                            } else {
                                report += `â€¢ Event Double(40 stamina/run): ${dailyLimit} runsÃ—${doubleDropDays} days (${dailyLimit * doubleDropDays * 40} stamina)\n`;
                            }
                        }
                        
                        report += `â€¢ Reduced Load(80 stamina/run): ${reducedRuns} runs (${reducedRuns * 80} stamina) - 2x material drops\n`;
                    }
                    
                } else if (shortages.purple > 0) {
                    const runs = Math.ceil(shortages.purple / 1.59);
                    const doubleRuns = Math.ceil(runs / 2);
                    const reducedRuns = Math.ceil(runs / 2);
                    
                    if (currentLanguage === 'zh') {
                        report += `ç¼ºå£: ${shortages.purple}ç´«\n`;
                        report += `â€¢ å¸¸è¦(40é«”/å ´): ${runs}å ´ (${runs * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${doubleRuns}å ´ (${doubleRuns * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): ${reducedRuns}å ´ (${reducedRuns * 80}é«”åŠ›)\n`;
                    } else {
                        report += `Deficit: ${shortages.purple} Purple\n`;
                        report += `â€¢ Normal(40 stamina/run): ${runs} runs (${runs * 40} stamina)\n`;
                        report += `â€¢ Event Double(40 stamina/run): ${doubleRuns} runs (${doubleRuns * 40} stamina)\n`;
                        report += `â€¢ Reduced Load(80 stamina/run): ${reducedRuns} runs (${reducedRuns * 80} stamina)\n`;
                    }
                    
                } else if (shortages.blue > 0) {
                    const runs = Math.ceil(shortages.blue / 8.00);
                    const doubleRuns = Math.ceil(runs / 2);
                    const reducedRuns = Math.ceil(runs / 2);
                    
                    if (currentLanguage === 'zh') {
                        report += `ç¼ºå£: ${shortages.blue}è—\n`;
                        report += `â€¢ å¸¸è¦(40é«”/å ´): ${runs}å ´ (${runs * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${doubleRuns}å ´ (${doubleRuns * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): ${reducedRuns}å ´ (${reducedRuns * 80}é«”åŠ›)\n`;
                    } else {
                        report += `Deficit: ${shortages.blue} Blue\n`;
                        report += `â€¢ Normal(40 stamina/run): ${runs} runs (${runs * 40} stamina)\n`;
                        report += `â€¢ Event Double(40 stamina/run): ${doubleRuns} runs (${doubleRuns * 40} stamina)\n`;
                        report += `â€¢ Reduced Load(80 stamina/run): ${reducedRuns} runs (${reducedRuns * 80} stamina)\n`;
                    }
                    
                } else if (shortages.green > 0) {
                    const runs = Math.ceil(shortages.green / 6.42);
                    const doubleRuns = Math.ceil(runs / 2);
                    const reducedRuns = Math.ceil(runs / 2);
                    
                    if (currentLanguage === 'zh') {
                        report += `ç¼ºå£: ${shortages.green}ç¶ \n`;
                        report += `â€¢ å¸¸è¦(40é«”/å ´): ${runs}å ´ (${runs * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ´»å‹•é›™å€(40é«”/å ´): ${doubleRuns}å ´ (${doubleRuns * 40}é«”åŠ›)\n`;
                        report += `â€¢ æ¸›è² é€”å¾‘(80é«”/å ´): ${reducedRuns}å ´ (${reducedRuns * 80}é«”åŠ›)\n`;
                    } else {
                        report += `Deficit: ${shortages.green} Green\n`;
                        report += `â€¢ Normal(40 stamina/run): ${runs} runs (${runs * 40} stamina)\n`;
                        report += `â€¢ Event Double(40 stamina/run): ${doubleRuns} runs (${doubleRuns * 40} stamina)\n`;
                        report += `â€¢ Reduced Load(80 stamina/run): ${reducedRuns} runs (${reducedRuns * 80} stamina)\n`;
                    }
                }
            }

            return report;
        }

        // Update execution preview - only shows synthesis results, not domain farming
        function updateExecutionPreview(calculation) {
            const {current, targets} = calculation;
            
            // Simulate only the synthesis strategy execution
            let simulatedAmounts = {...current};
            
            // Execute the same synthesis logic as in calculateOptimalStrategy
            const goldDeficit = Math.max(0, targets.gold - current.gold);
            const purpleNeededForGold = goldDeficit * 3;
            const totalPurpleNeeded = targets.purple + purpleNeededForGold;
            const purpleDeficit = Math.max(0, totalPurpleNeeded - current.purple);
            const blueNeededForPurple = purpleDeficit * 3;
            const totalBlueNeeded = targets.blue + blueNeededForPurple;
            const blueDeficit = Math.max(0, totalBlueNeeded - current.blue);
            const availableGreen = Math.max(0, current.green - targets.green);

            // Green -> Blue synthesis
            const greenToBlueSynthesis = Math.min(Math.floor(availableGreen / 3), blueDeficit);
            if (greenToBlueSynthesis > 0) {
                simulatedAmounts.green -= greenToBlueSynthesis * 3;
                simulatedAmounts.blue += greenToBlueSynthesis;
            }

            // Blue -> Purple synthesis
            const availableBlue = simulatedAmounts.blue - targets.blue;
            const blueToPurpleSynthesis = Math.min(Math.floor(Math.max(0, availableBlue) / 3), purpleDeficit);
            if (blueToPurpleSynthesis > 0) {
                simulatedAmounts.blue -= blueToPurpleSynthesis * 3;
                simulatedAmounts.purple += blueToPurpleSynthesis;
            }

            // Purple -> Gold synthesis
            const availablePurple = simulatedAmounts.purple - targets.purple;
            const purpleToGoldSynthesis = Math.min(Math.floor(Math.max(0, availablePurple) / 3), goldDeficit);
            if (purpleToGoldSynthesis > 0) {
                simulatedAmounts.purple -= purpleToGoldSynthesis * 3;
                simulatedAmounts.gold += purpleToGoldSynthesis;
            }
            
            // Update display with synthesis-only results
            const colors = ['green', 'blue', 'purple', 'gold'];
            colors.forEach(color => {
                const final = Math.floor(simulatedAmounts[color]);
                const target = targets[color];
                const diff = final - target;
                
                const unitText = currentLanguage === 'zh' ? ' å€‹' : '';
                document.getElementById(`preview-${color}`).textContent = final + unitText;
                
                if (diff >= 0) {
                    const statusText = currentLanguage === 'zh' ? `âœ“ é”æ¨™ +${diff}` : `âœ“ Met +${diff}`;
                    document.getElementById(`preview-${color}-status`).textContent = statusText;
                    document.getElementById(`preview-${color}-status`).className = 'text-xs opacity-90 text-green-600';
                } else {
                    const statusText = currentLanguage === 'zh' ? `âœ— ä¸è¶³ ${Math.abs(diff)}` : `âœ— Short ${Math.abs(diff)}`;
                    document.getElementById(`preview-${color}-status`).textContent = statusText;
                    document.getElementById(`preview-${color}-status`).className = 'text-xs opacity-90 text-red-600';
                }
            });
        }

        // Perform calculation function (used by both auto-calculation and manual trigger)
        function performCalculation() {
            // æª¢æŸ¥æ˜¯å¦æœ‰æŒæœ‰æ•¸é‡è¼¸å…¥ï¼Œé¿å…åœ¨åˆå§‹åŒ–æ™‚é¡¯ç¤ºéŒ¯èª¤ä¿¡æ¯
            const hasInput = ['current-green', 'current-blue', 'current-purple', 'current-gold']
                .some(id => parseInt(document.getElementById(id).value) > 0);
            
            if (!hasInput) {
                // å¦‚æœæ²’æœ‰è¼¸å…¥æŒæœ‰æ•¸é‡ï¼Œé¡¯ç¤ºæç¤ºä¿¡æ¯
                const placeholderText = getNestedValue(i18nData[currentLanguage], 'strategy.placeholder');
                document.getElementById('strategy-display').innerHTML = `<div class="bg-gray-50 rounded-lg p-4 text-center border-2 border-dashed border-gray-300"><p class="card-content text-base">${placeholderText}</p></div>`;
                document.getElementById('report-content').textContent = getNestedValue(i18nData[currentLanguage], 'report.placeholder');
                
                // é‡ç½®åŸ·è¡Œé è¦½
                ['green', 'blue', 'purple', 'gold'].forEach(color => {
                    document.getElementById(`preview-${color}`).textContent = '-';
                    document.getElementById(`preview-${color}-status`).textContent = '-';
                    document.getElementById(`preview-${color}-status`).className = 'text-xs card-content';
                });
                return;
            }

            const calculation = calculateOptimalStrategy();
            const {strategy, current, targets} = calculation;

            // æª¢æŸ¥æ˜¯å¦æœ‰åš´é‡ç´ æä¸è¶³çš„æƒ…æ³
            const shortages = {
                green: Math.max(0, targets.green - current.green),
                blue: Math.max(0, targets.blue - current.blue),
                purple: Math.max(0, targets.purple - current.purple),
                gold: Math.max(0, targets.gold - current.gold)
            };

            // Update strategy display
            const strategyDisplay = document.getElementById('strategy-display');
            
            if (strategy.length === 0) {
                const noSynthesisText = getNestedValue(i18nData[currentLanguage], 'strategy.noSynthesis');
                strategyDisplay.innerHTML = `<p class="text-green-600 font-semibold">${noSynthesisText}</p>`;
            } else {
                strategyDisplay.innerHTML = strategy.map(step => 
                    `<div class="bg-blue-50 p-2 rounded border-l-4 border-blue-400">${step}</div>`
                ).join('');
            }

            // Update execution preview
            updateExecutionPreview(calculation);

            // Generate and display report
            const report = generateReport(calculation);
            document.getElementById('report-content').textContent = report;

            // Generate and display calculation process
            const process = generateCalculationProcess(calculation);
            document.getElementById('calculation-process').textContent = process;
        }

        // Event listeners
        document.getElementById('max-cultivation-btn').addEventListener('click', function() {
            this.classList.add('pulse-animation');
            setTimeout(() => this.classList.remove('pulse-animation'), 1000);

            // Set all skills to maximum level
            setAllSkillLevels(10);
            
            // Set weapon to maximum level
            setWeaponLevel(90);
            
            // Recalculate requirements and perform calculation
            calculateRequirements();
            performCalculation();
        });

        document.getElementById('reset-default-btn').addEventListener('click', function() {
            // Reset to character + weapon full requirements
            setAllSkillLevels(10);
            setWeaponLevel(90);
            
            calculateRequirements();
        });

        document.getElementById('reset-all-btn').addEventListener('click', function() {
            // Reset everything to initial state
            setAllSkillLevels(1);
            setWeaponLevel(1);
            
            ['current-green', 'current-blue', 'current-purple', 'current-gold'].forEach(id => {
                document.getElementById(id).value = 0;
            });

            const placeholderText = getNestedValue(i18nData[currentLanguage], 'strategy.placeholder');
            document.getElementById('strategy-display').innerHTML = `<div class="bg-gray-50 rounded-lg p-4 text-center border-2 border-dashed border-gray-300"><p class="card-content text-base">${placeholderText}</p></div>`;
            document.getElementById('report-content').textContent = getNestedValue(i18nData[currentLanguage], 'report.placeholder');
            
            // Reset execution preview
            ['green', 'blue', 'purple', 'gold'].forEach(color => {
                document.getElementById(`preview-${color}`).textContent = '-';
                document.getElementById(`preview-${color}-status`).textContent = '-';
            });
            
            calculateRequirements();
        });

        document.getElementById('copy-report-btn').addEventListener('click', async function() {
            const reportContent = document.getElementById('report-content').textContent;
            
            try {
                await navigator.clipboard.writeText(reportContent);
                
                const originalText = this.textContent;
                const copiedText = getNestedValue(i18nData[currentLanguage], 'messages.reportCopied');
                this.textContent = copiedText;
                this.classList.add('pulse-animation');
                
                setTimeout(() => {
                    this.textContent = originalText;
                    this.classList.remove('pulse-animation');
                }, 2000);
            } catch (err) {
                // Fallback for browsers that don't support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = reportContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const originalText = this.textContent;
                const copiedText = getNestedValue(i18nData[currentLanguage], 'messages.reportCopied');
                this.textContent = copiedText;
                setTimeout(() => {
                    this.textContent = originalText;
                }, 2000);
            }
        });

        // Add dynamic feedback effects to buttons
        function addButtonDynamicEffects() {
            // Add ripple effect to all buttons
            const buttons = document.querySelectorAll('button, .btn-primary, .btn-secondary, .btn-success, .btn-warning, .btn-info');
            
            buttons.forEach(button => {
                // Add ripple class
                button.classList.add('btn-ripple');
                
                // Add click feedback
                button.addEventListener('click', function(e) {
                    // Add bounce effect for important buttons
                    if (this.classList.contains('btn-primary') || this.classList.contains('btn-success')) {
                        this.style.animation = 'none';
                        setTimeout(() => {
                            this.style.animation = 'bounce 0.6s ease';
                        }, 10);
                    }
                    
                    // Show loading state for action buttons
                    if (this.id === 'save-record-btn' || this.id === 'clear-records-btn') {
                        showButtonLoading(this);
                        setTimeout(() => {
                            hideButtonLoading(this);
                            showButtonSuccess(this);
                        }, 800);
                    }
                });
                
                // Add wiggle effect on hover for secondary buttons
                if (button.classList.contains('btn-secondary')) {
                    button.classList.add('btn-wiggle');
                }
                
                // Add breathe effect for special buttons
                if (button.id === 'save-record-btn') {
                    button.classList.add('btn-breathe');
                }
            });
            
            // Add special effects to skill level buttons
            const skillButtons = document.querySelectorAll('#skill-level-6, #skill-level-8, #skill-level-10');
            skillButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Add heartbeat effect
                    this.classList.add('btn-heartbeat');
                    setTimeout(() => {
                        this.classList.remove('btn-heartbeat');
                    }, 1500);
                });
            });
            
            // Add special hover effects to language buttons
            const langButtons = document.querySelectorAll('.language-btn');
            langButtons.forEach(btn => {
                btn.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('active')) {
                        this.style.animation = 'wiggle 0.5s ease';
                    }
                });
                
                btn.addEventListener('mouseleave', function() {
                    this.style.animation = '';
                });
            });
        }
        
        // Show button loading state
        function showButtonLoading(button) {
            if (!button.dataset.originalText) {
                button.dataset.originalText = button.textContent;
            }
            button.classList.add('btn-loading');
            button.disabled = true;
        }
        
        // Hide button loading state
        function hideButtonLoading(button) {
            button.classList.remove('btn-loading');
            button.disabled = false;
            if (button.dataset.originalText) {
                button.textContent = button.dataset.originalText;
            }
        }
        
        // Show button success state
        function showButtonSuccess(button) {
            const originalBg = button.style.background;
            button.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            button.classList.add('btn-success-check');
            
            setTimeout(() => {
                button.style.background = originalBg;
                button.classList.remove('btn-success-check');
            }, 1500);
        }
        
        // Show animated message
        function showAnimatedMessage(message) {
            // Create message element if it doesn't exist
            let messageEl = document.getElementById('animated-message');
            if (!messageEl) {
                messageEl = document.createElement('div');
                messageEl.id = 'animated-message';
                messageEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #10b981, #059669);
                    color: white;
                    padding: 12px 20px;
                    border-radius: 12px;
                    font-weight: 500;
                    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
                    z-index: 1000;
                    transform: translateX(400px);
                    transition: all 0.3s ease;
                `;
                document.body.appendChild(messageEl);
            }
            
            messageEl.textContent = message;
            
            // Show message
            setTimeout(() => {
                messageEl.style.transform = 'translateX(0)';
            }, 100);
            
            // Hide message after 3 seconds
            setTimeout(() => {
                messageEl.style.transform = 'translateX(400px)';
            }, 3000);
        }

        // Initialize the application
        function initializeApp() {
            // Load saved language preference
            const savedLang = localStorage.getItem('wuthering-waves-language') || 'zh';
            currentLanguage = savedLang;
            
            // Initialize current weapon level
            window.currentWeaponLevel = 1;
            
            // Initialize all components
            initializeSliders();
            updateLanguage(savedLang);
            calculateRequirements();
            renderRecords();
            
            // Add dynamic button effects
            addButtonDynamicEffects();
        }

        // Start the application
        initializeApp();
    </script>
</body>

    <!-- é é¢åº•éƒ¨ GITHUB ä¾†æºé€£çµ -->
    <footer style="width:100%;text-align:center;padding:24px 0 12px 0;font-size:1.05em;color:#e5edf5;background:#0c1526;">
        åŸå§‹ç¢¼ä¾†æºï¼š<a href="https://github.com/Sid-1996/WutheringWaves-Resource-Calculator" target="_blank" rel="noopener" style="color:#7fd6d8;text-decoration:underline;">GitHub - Sid-1996/WutheringWaves-Resource-Calculator</a>
    </footer>
</html>
